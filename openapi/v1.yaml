openapi: 3.1.0
info:
  title: claro_data API
  version: 1.0.0
  description: API base v1 para ingestion, clasificacion, analisis y gestion de contenido.
servers:
  - url: https://{api_id}.execute-api.us-east-1.amazonaws.com/prod
    variables:
      api_id:
        default: replace-me
security:
  - bearerAuth: []
tags:
  - name: Terms
  - name: Ingestion
  - name: Content
  - name: Feed
  - name: Monitor
  - name: Analysis
  - name: Exports
  - name: Reports
  - name: Meta
  - name: Connectors
  - name: Config
  - name: Audit
paths:
  /v1/health:
    get:
      summary: Healthcheck
      security: []
      responses:
        '200':
          description: API disponible
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    const: ok
                  service:
                    type: string
                  timestamp:
                    type: string
                    format: date-time
  /v1/terms:
    get:
      tags: [Terms]
      summary: Listar terminos monitoreados (legacy wrapper de queries)
      deprecated: true
      parameters:
        - $ref: '#/components/parameters/Cursor'
        - $ref: '#/components/parameters/Limit'
        - name: scope
          in: query
          schema:
            $ref: '#/components/schemas/TermScope'
          description: Filtra terminos por alcance de monitoreo (`claro|competencia`).
      responses:
        '200':
          description: Lista de terminos
          headers:
            X-Legacy-Endpoint:
              description: Endpoint legacy temporal; migrar a `/v1/config/queries`.
              schema:
                type: string
                const: "true"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TermListResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
    post:
      tags: [Terms]
      summary: Crear termino monitoreado (legacy wrapper de queries)
      deprecated: true
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateTermRequest'
      responses:
        '201':
          description: Termino creado
          headers:
            X-Legacy-Endpoint:
              description: Endpoint legacy temporal; migrar a `/v1/config/queries`.
              schema:
                type: string
                const: "true"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Term'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/terms/{id}:
    patch:
      tags: [Terms]
      summary: Editar termino monitoreado (legacy wrapper de queries)
      deprecated: true
      parameters:
        - $ref: '#/components/parameters/Id'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateTermRequest'
      responses:
        '200':
          description: Termino actualizado
          headers:
            X-Legacy-Endpoint:
              description: Endpoint legacy temporal; migrar a `/v1/config/queries`.
              schema:
                type: string
                const: "true"
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Term'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/config/queries:
    get:
      tags: [Config]
      summary: Listar queries configuradas de noticias
      parameters:
        - $ref: '#/components/parameters/Cursor'
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 300
            default: 100
        - name: scope
          in: query
          schema:
            $ref: '#/components/schemas/TermScope'
        - name: is_active
          in: query
          schema:
            type: boolean
        - name: language
          in: query
          schema:
            type: string
        - name: q
          in: query
          schema:
            type: string
      responses:
        '200':
          description: Lista de queries configuradas
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConfigQueryListResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
    post:
      tags: [Config]
      summary: Crear query configurada de noticias
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateConfigQueryRequest'
      responses:
        '201':
          description: Query creada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NewsQuery'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/config/queries/preview:
    post:
      tags: [Config]
      summary: Preview local de una definicion de query sin persistir
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ConfigQueryPreviewRequest'
      responses:
        '200':
          description: Resultado del preview local
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConfigQueryPreviewResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/config/queries/{id}:
    get:
      tags: [Config]
      summary: Obtener detalle de una query configurada
      parameters:
        - $ref: '#/components/parameters/Id'
      responses:
        '200':
          description: Query configurada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NewsQuery'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '422':
          $ref: '#/components/responses/ValidationError'
    patch:
      tags: [Config]
      summary: Editar query configurada
      parameters:
        - $ref: '#/components/parameters/Id'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateConfigQueryRequest'
      responses:
        '200':
          description: Query actualizada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NewsQuery'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
    delete:
      tags: [Config]
      summary: Hard delete de query configurada
      parameters:
        - $ref: '#/components/parameters/Id'
      responses:
        '200':
          description: Query eliminada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConfigQueryDeleteResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/config/queries/{id}/revisions:
    get:
      tags: [Config]
      summary: Listar revisiones de una query configurada
      parameters:
        - $ref: '#/components/parameters/Id'
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 300
            default: 100
      responses:
        '200':
          description: Lista de revisiones
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConfigQueryRevisionListResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/config/queries/{id}/rollback:
    post:
      tags: [Config]
      summary: Rollback de query a una revision previa
      parameters:
        - $ref: '#/components/parameters/Id'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ConfigQueryRollbackRequest'
      responses:
        '200':
          description: Query restaurada desde revision previa
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NewsQuery'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/config/queries/{id}/dry-run:
    post:
      tags: [Config]
      summary: Dry-run contra proveedores sin persistir contenido
      parameters:
        - $ref: '#/components/parameters/Id'
      requestBody:
        required: false
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ConfigQueryDryRunRequest'
      responses:
        '200':
          description: Resultado dry-run por proveedor
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConfigQueryDryRunResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/ingestion/runs:
    post:
      tags: [Ingestion]
      summary: Disparar corrida manual de ingestion
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateIngestionRunRequest'
      responses:
        '202':
          description: Corrida aceptada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/IngestionRunAccepted'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/content:
    get:
      tags: [Content]
      summary: Listado de contenido con filtros avanzados y cursor
      parameters:
        - $ref: '#/components/parameters/Cursor'
        - $ref: '#/components/parameters/Limit'
        - name: state
          in: query
          schema:
            $ref: '#/components/schemas/ContentState'
        - name: source_type
          in: query
          schema:
            $ref: '#/components/schemas/SourceType'
        - name: term_id
          in: query
          schema:
            type: string
            format: uuid
        - name: provider
          in: query
          schema:
            type: string
        - name: category
          in: query
          schema:
            type: string
        - name: sentimiento
          in: query
          schema:
            type: string
        - name: from
          in: query
          schema:
            type: string
            format: date-time
        - name: to
          in: query
          schema:
            type: string
            format: date-time
        - name: q
          in: query
          schema:
            type: string
        - name: origin
          in: query
          schema:
            $ref: '#/components/schemas/OriginType'
        - name: medium
          in: query
          schema:
            type: string
        - name: tag
          in: query
          schema:
            type: string
          description: Tag individual o lista CSV (`origin:news,provider:newsapi`)
      responses:
        '200':
          description: Lista paginada de contenido
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ContentListResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/feed/news:
    get:
      tags: [Feed]
      summary: Feed unificado por query (news + awario) deduplicado y paginado
      parameters:
        - name: term_id
          in: query
          required: true
          schema:
            type: string
            format: uuid
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 200
            default: 20
        - $ref: '#/components/parameters/Cursor'
        - name: origin
          in: query
          schema:
            $ref: '#/components/schemas/OriginType'
        - name: medium
          in: query
          schema:
            type: string
        - name: tag
          in: query
          schema:
            type: string
          description: Tag individual o lista CSV (`origin:news,provider:newsapi`)
      responses:
        '200':
          description: Feed unificado paginado para la query
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NewsFeedResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '409':
          $ref: '#/components/responses/Conflict'
        '404':
          $ref: '#/components/responses/NotFound'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/monitor/overview:
    get:
      tags: [Monitor]
      summary: KPIs de overview (V1 news-only, ventana fija de 7 dias)
      responses:
        '200':
          description: Resumen KPI de monitoreo
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MonitorOverviewResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          description: Error interno
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /v1/monitor/social/overview:
    get:
      tags: [Monitor]
      summary: Resumen social analytics V2 (no oficial)
      parameters:
        - name: preset
          in: query
          schema:
            $ref: '#/components/schemas/SocialDatePreset'
        - name: window_days
          in: query
          schema:
            type: integer
            enum: [7, 30, 90]
        - name: from
          in: query
          schema:
            type: string
            format: date-time
        - name: to
          in: query
          schema:
            type: string
            format: date-time
        - name: channel
          in: query
          schema:
            type: string
          description: Canal o lista CSV de canales (`facebook,instagram,...`)
        - name: account
          in: query
          schema:
            type: string
          description: Cuenta o lista CSV de cuentas
        - name: post_type
          in: query
          schema:
            type: string
          description: Tipo de post o lista CSV de tipos (`unknown` para vacios)
        - name: trend_granularity
          in: query
          schema:
            $ref: '#/components/schemas/SocialTrendGranularity'
        - name: sentiment
          in: query
          schema:
            $ref: '#/components/schemas/SocialSentiment'
        - name: campaign
          in: query
          schema:
            type: string
          description: Campaña o lista CSV de campañas
        - name: strategy
          in: query
          schema:
            type: string
          description: Estrategia o lista CSV de estrategias
        - name: hashtag
          in: query
          schema:
            type: string
          description: Hashtag o lista CSV de hashtags (con o sin #)
        - name: topic
          in: query
          schema:
            type: string
          description: Topic de taxonomia social_topic o lista CSV de topics
        - name: comparison_mode
          in: query
          schema:
            $ref: '#/components/schemas/SocialComparisonMode'
        - name: comparison_days
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 366
      responses:
        '200':
          description: Resumen KPI social
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MonitorSocialOverviewResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/monitor/social/accounts:
    get:
      tags: [Monitor]
      summary: Ranking de cuentas social analytics V2
      parameters:
        - name: cursor
          in: query
          schema:
            type: string
          description: Cursor opaco para paginacion de cuentas
        - name: preset
          in: query
          schema:
            $ref: '#/components/schemas/SocialDatePreset'
        - name: window_days
          in: query
          schema:
            type: integer
            enum: [7, 30, 90]
        - name: from
          in: query
          schema:
            type: string
            format: date-time
        - name: to
          in: query
          schema:
            type: string
            format: date-time
        - name: channel
          in: query
          schema:
            type: string
          description: Canal o lista CSV de canales (`facebook,instagram,...`)
        - name: account
          in: query
          schema:
            type: string
          description: Cuenta o lista CSV de cuentas
        - name: post_type
          in: query
          schema:
            type: string
          description: Tipo de post o lista CSV de tipos (`unknown` para vacios)
        - name: sentiment
          in: query
          schema:
            $ref: '#/components/schemas/SocialSentiment'
        - name: campaign
          in: query
          schema:
            type: string
          description: Campaña o lista CSV de campañas
        - name: strategy
          in: query
          schema:
            type: string
          description: Estrategia o lista CSV de estrategias
        - name: hashtag
          in: query
          schema:
            type: string
          description: Hashtag o lista CSV de hashtags (con o sin #)
        - name: topic
          in: query
          schema:
            type: string
          description: Topic de taxonomia social_topic o lista CSV de topics
        - name: comparison_mode
          in: query
          schema:
            $ref: '#/components/schemas/SocialComparisonMode'
        - name: comparison_days
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 366
        - name: min_posts
          in: query
          schema:
            type: integer
            default: 5
        - name: min_exposure
          in: query
          schema:
            type: integer
            default: 5000
        - name: sort
          in: query
          schema:
            $ref: '#/components/schemas/SocialAccountsSort'
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 500
            default: 100
      responses:
        '200':
          description: Ranking de cuentas
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MonitorSocialAccountsResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/monitor/social/facets:
    get:
      tags: [Monitor]
      summary: Facetas agregadas por filtro para triage social analytics V2
      parameters:
        - name: preset
          in: query
          schema:
            $ref: '#/components/schemas/SocialDatePreset'
        - name: window_days
          in: query
          schema:
            type: integer
            enum: [7, 30, 90]
        - name: from
          in: query
          schema:
            type: string
            format: date-time
        - name: to
          in: query
          schema:
            type: string
            format: date-time
        - name: channel
          in: query
          schema:
            type: string
          description: Canal o lista CSV de canales (`facebook,instagram,...`)
        - name: account
          in: query
          schema:
            type: string
          description: Cuenta o lista CSV de cuentas
        - name: post_type
          in: query
          schema:
            type: string
          description: Tipo de post o lista CSV de tipos (`unknown` para vacios)
        - name: sentiment
          in: query
          schema:
            $ref: '#/components/schemas/SocialSentiment'
        - name: campaign
          in: query
          schema:
            type: string
          description: Campaña o lista CSV de campañas
        - name: strategy
          in: query
          schema:
            type: string
          description: Estrategia o lista CSV de estrategias
        - name: hashtag
          in: query
          schema:
            type: string
          description: Hashtag o lista CSV de hashtags (con o sin #)
        - name: topic
          in: query
          schema:
            type: string
          description: Topic de taxonomia social_topic o lista CSV de topics
        - name: comparison_mode
          in: query
          schema:
            $ref: '#/components/schemas/SocialComparisonMode'
        - name: comparison_days
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 366
      responses:
        '200':
          description: Facetas de filtros
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MonitorSocialFacetsResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/monitor/social/posts:
    get:
      tags: [Monitor]
      summary: Listado paginado de posts social analytics V2
      parameters:
        - $ref: '#/components/parameters/Cursor'
        - $ref: '#/components/parameters/Limit'
        - name: preset
          in: query
          schema:
            $ref: '#/components/schemas/SocialDatePreset'
        - name: window_days
          in: query
          schema:
            type: integer
            enum: [7, 30, 90]
        - name: from
          in: query
          schema:
            type: string
            format: date-time
        - name: to
          in: query
          schema:
            type: string
            format: date-time
        - name: channel
          in: query
          schema:
            type: string
          description: Canal o lista CSV de canales (`facebook,instagram,...`)
        - name: account
          in: query
          schema:
            type: string
          description: Cuenta o lista CSV de cuentas
        - name: post_type
          in: query
          schema:
            type: string
          description: Tipo de post o lista CSV de tipos (`unknown` para vacios)
        - name: sentiment
          in: query
          schema:
            $ref: '#/components/schemas/SocialSentiment'
        - name: campaign
          in: query
          schema:
            type: string
          description: Campaña o lista CSV de campañas
        - name: strategy
          in: query
          schema:
            type: string
          description: Estrategia o lista CSV de estrategias
        - name: hashtag
          in: query
          schema:
            type: string
          description: Hashtag o lista CSV de hashtags (con o sin #)
        - name: topic
          in: query
          schema:
            type: string
          description: Topic de taxonomia social_topic o lista CSV de topics
        - name: comparison_mode
          in: query
          schema:
            $ref: '#/components/schemas/SocialComparisonMode'
        - name: comparison_days
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 366
        - name: sort
          in: query
          schema:
            $ref: '#/components/schemas/SocialPostSort'
        - name: origin
          in: query
          schema:
            $ref: '#/components/schemas/OriginType'
        - name: medium
          in: query
          schema:
            type: string
        - name: tag
          in: query
          schema:
            type: string
          description: Tag individual o lista CSV (`origin:awario,channel:facebook`)
      responses:
        '200':
          description: Posts sociales
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MonitorSocialPostsResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/monitor/social/posts/{post_id}/comments:
    get:
      tags: [Monitor]
      summary: Listado paginado de comentarios Awario vinculados a un post
      parameters:
        - name: post_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - $ref: '#/components/parameters/Cursor'
        - $ref: '#/components/parameters/Limit'
        - name: sentiment
          in: query
          schema:
            $ref: '#/components/schemas/SocialSentiment'
        - name: is_spam
          in: query
          schema:
            type: boolean
        - name: related_to_post_text
          in: query
          schema:
            type: boolean
        - name: origin
          in: query
          schema:
            $ref: '#/components/schemas/OriginType'
        - name: medium
          in: query
          schema:
            type: string
        - name: tag
          in: query
          schema:
            type: string
          description: Tag individual o lista CSV (`origin:awario,alert:12345`)
      responses:
        '200':
          description: Comentarios Awario del post
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MonitorSocialPostCommentsResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/monitor/social/comments/{comment_id}:
    patch:
      tags: [Monitor]
      summary: Override manual de comentario Awario (spam/relacion/sentimiento)
      parameters:
        - name: comment_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchMonitorSocialCommentRequest'
      responses:
        '200':
          description: Comentario actualizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MonitorSocialCommentItem'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/monitor/social/risk:
    get:
      tags: [Monitor]
      summary: Tendencias de riesgo y sentimiento social analytics V2
      parameters:
        - name: preset
          in: query
          schema:
            $ref: '#/components/schemas/SocialDatePreset'
        - name: window_days
          in: query
          schema:
            type: integer
            enum: [7, 30, 90]
        - name: from
          in: query
          schema:
            type: string
            format: date-time
        - name: to
          in: query
          schema:
            type: string
            format: date-time
        - name: channel
          in: query
          schema:
            type: string
          description: Canal o lista CSV de canales (`facebook,instagram,...`)
        - name: account
          in: query
          schema:
            type: string
          description: Cuenta o lista CSV de cuentas
        - name: post_type
          in: query
          schema:
            type: string
          description: Tipo de post o lista CSV de tipos (`unknown` para vacios)
        - name: sentiment
          in: query
          schema:
            $ref: '#/components/schemas/SocialSentiment'
        - name: campaign
          in: query
          schema:
            type: string
          description: Campaña o lista CSV de campañas
        - name: strategy
          in: query
          schema:
            type: string
          description: Estrategia o lista CSV de estrategias
        - name: hashtag
          in: query
          schema:
            type: string
          description: Hashtag o lista CSV de hashtags (con o sin #)
        - name: topic
          in: query
          schema:
            type: string
          description: Topic de taxonomia social_topic o lista CSV de topics
        - name: comparison_mode
          in: query
          schema:
            $ref: '#/components/schemas/SocialComparisonMode'
        - name: comparison_days
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 366
      responses:
        '200':
          description: Riesgo social
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MonitorSocialRiskResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/monitor/social/charts/heatmap:
    get:
      tags: [Monitor]
      summary: Dataset heatmap dia x mes para metrica seleccionada
      parameters:
        - name: preset
          in: query
          schema:
            $ref: '#/components/schemas/SocialDatePreset'
        - name: window_days
          in: query
          schema:
            type: integer
            enum: [7, 30, 90]
        - name: from
          in: query
          schema:
            type: string
            format: date-time
        - name: to
          in: query
          schema:
            type: string
            format: date-time
        - name: channel
          in: query
          schema:
            type: string
          description: Canal o lista CSV de canales (`facebook,instagram,...`)
        - name: account
          in: query
          schema:
            type: string
          description: Cuenta o lista CSV de cuentas
        - name: post_type
          in: query
          schema:
            type: string
          description: Tipo de post o lista CSV de tipos (`unknown` para vacios)
        - name: campaign
          in: query
          schema:
            type: string
          description: Campaña o lista CSV de campañas
        - name: strategy
          in: query
          schema:
            type: string
          description: Estrategia o lista CSV de estrategias
        - name: hashtag
          in: query
          schema:
            type: string
          description: Hashtag o lista CSV de hashtags (con o sin #)
        - name: topic
          in: query
          schema:
            type: string
          description: Topic de taxonomia social_topic o lista CSV de topics
        - name: comparison_mode
          in: query
          schema:
            $ref: '#/components/schemas/SocialComparisonMode'
        - name: comparison_days
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 366
        - name: metric
          in: query
          schema:
            $ref: '#/components/schemas/SocialHeatmapMetric'
      responses:
        '200':
          description: Dataset heatmap
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MonitorSocialHeatmapResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/monitor/social/charts/scatter:
    get:
      tags: [Monitor]
      summary: Dataset scatter ER vs exposicion por dimension
      parameters:
        - name: preset
          in: query
          schema:
            $ref: '#/components/schemas/SocialDatePreset'
        - name: window_days
          in: query
          schema:
            type: integer
            enum: [7, 30, 90]
        - name: from
          in: query
          schema:
            type: string
            format: date-time
        - name: to
          in: query
          schema:
            type: string
            format: date-time
        - name: channel
          in: query
          schema:
            type: string
          description: Canal o lista CSV de canales (`facebook,instagram,...`)
        - name: account
          in: query
          schema:
            type: string
          description: Cuenta o lista CSV de cuentas
        - name: post_type
          in: query
          schema:
            type: string
          description: Tipo de post o lista CSV de tipos (`unknown` para vacios)
        - name: campaign
          in: query
          schema:
            type: string
          description: Campaña o lista CSV de campañas
        - name: strategy
          in: query
          schema:
            type: string
          description: Estrategia o lista CSV de estrategias
        - name: hashtag
          in: query
          schema:
            type: string
          description: Hashtag o lista CSV de hashtags (con o sin #)
        - name: topic
          in: query
          schema:
            type: string
          description: Topic de taxonomia social_topic o lista CSV de topics
        - name: comparison_mode
          in: query
          schema:
            $ref: '#/components/schemas/SocialComparisonMode'
        - name: comparison_days
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 366
        - name: dimension
          in: query
          schema:
            $ref: '#/components/schemas/SocialScatterDimension'
      responses:
        '200':
          description: Dataset scatter
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MonitorSocialScatterResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/monitor/social/charts/trend-by-dimension:
    get:
      tags: [Monitor]
      summary: Serie temporal por dimensión para una métrica seleccionada
      parameters:
        - name: preset
          in: query
          schema:
            $ref: '#/components/schemas/SocialDatePreset'
        - name: window_days
          in: query
          schema:
            type: integer
            enum: [7, 30, 90]
        - name: from
          in: query
          schema:
            type: string
            format: date-time
        - name: to
          in: query
          schema:
            type: string
            format: date-time
        - name: channel
          in: query
          schema:
            type: string
          description: Canal o lista CSV de canales (`facebook,instagram,...`)
        - name: account
          in: query
          schema:
            type: string
          description: Cuenta o lista CSV de cuentas
        - name: post_type
          in: query
          schema:
            type: string
          description: Tipo de post o lista CSV de tipos (`unknown` para vacios)
        - name: campaign
          in: query
          schema:
            type: string
          description: Campaña o lista CSV de campañas
        - name: strategy
          in: query
          schema:
            type: string
          description: Estrategia o lista CSV de estrategias
        - name: hashtag
          in: query
          schema:
            type: string
          description: Hashtag o lista CSV de hashtags (con o sin #)
        - name: topic
          in: query
          schema:
            type: string
          description: Topic de taxonomia social_topic o lista CSV de topics
        - name: sentiment
          in: query
          schema:
            $ref: '#/components/schemas/SocialSentiment'
        - name: trend_granularity
          in: query
          schema:
            $ref: '#/components/schemas/SocialTrendGranularity'
        - name: comparison_mode
          in: query
          schema:
            $ref: '#/components/schemas/SocialComparisonMode'
        - name: comparison_days
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 366
        - name: dimension
          in: query
          schema:
            $ref: '#/components/schemas/SocialScatterDimension'
        - name: metric
          in: query
          schema:
            $ref: '#/components/schemas/SocialTrendByDimensionMetric'
        - name: series_limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 50
      responses:
        '200':
          description: Dataset de tendencia por dimensión
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MonitorSocialTrendByDimensionResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/monitor/social/charts/er-breakdown:
    get:
      tags: [Monitor]
      summary: Dataset agregado ER por dimension analitica
      parameters:
        - name: preset
          in: query
          schema:
            $ref: '#/components/schemas/SocialDatePreset'
        - name: window_days
          in: query
          schema:
            type: integer
            enum: [7, 30, 90]
        - name: from
          in: query
          schema:
            type: string
            format: date-time
        - name: to
          in: query
          schema:
            type: string
            format: date-time
        - name: channel
          in: query
          schema:
            type: string
          description: Canal o lista CSV de canales (`facebook,instagram,...`)
        - name: account
          in: query
          schema:
            type: string
          description: Cuenta o lista CSV de cuentas
        - name: post_type
          in: query
          schema:
            type: string
          description: Tipo de post o lista CSV de tipos (`unknown` para vacios)
        - name: campaign
          in: query
          schema:
            type: string
          description: Campaña o lista CSV de campañas
        - name: strategy
          in: query
          schema:
            type: string
          description: Estrategia o lista CSV de estrategias
        - name: hashtag
          in: query
          schema:
            type: string
          description: Hashtag o lista CSV de hashtags (con o sin #)
        - name: topic
          in: query
          schema:
            type: string
          description: Topic de taxonomia social_topic o lista CSV de topics
        - name: comparison_mode
          in: query
          schema:
            $ref: '#/components/schemas/SocialComparisonMode'
        - name: comparison_days
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 366
        - name: dimension
          in: query
          schema:
            $ref: '#/components/schemas/SocialErBreakdownDimension'
      responses:
        '200':
          description: Dataset ER por dimension
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MonitorSocialErBreakdownResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/monitor/social/charts/topic-breakdown:
    get:
      tags: [Monitor]
      summary: Distribucion por tema con segunda dimension seleccionable
      parameters:
        - name: preset
          in: query
          schema:
            $ref: '#/components/schemas/SocialDatePreset'
        - name: window_days
          in: query
          schema:
            type: integer
            enum: [7, 30, 90]
        - name: from
          in: query
          schema:
            type: string
            format: date-time
        - name: to
          in: query
          schema:
            type: string
            format: date-time
        - name: channel
          in: query
          schema:
            type: string
          description: Canal o lista CSV de canales (`facebook,instagram,...`)
        - name: account
          in: query
          schema:
            type: string
          description: Cuenta o lista CSV de cuentas
        - name: post_type
          in: query
          schema:
            type: string
          description: Tipo de post o lista CSV de tipos (`unknown` para vacios)
        - name: campaign
          in: query
          schema:
            type: string
          description: Campaña o lista CSV de campañas
        - name: strategy
          in: query
          schema:
            type: string
          description: Estrategia o lista CSV de estrategias
        - name: hashtag
          in: query
          schema:
            type: string
          description: Hashtag o lista CSV de hashtags (con o sin #)
        - name: topic
          in: query
          schema:
            type: string
          description: Topic de taxonomia social_topic o lista CSV de topics
        - name: sentiment
          in: query
          schema:
            $ref: '#/components/schemas/SocialSentiment'
        - name: comparison_mode
          in: query
          schema:
            $ref: '#/components/schemas/SocialComparisonMode'
        - name: comparison_days
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 366
        - name: dimension
          in: query
          schema:
            $ref: '#/components/schemas/SocialTopicBreakdownDimension'
        - name: metric
          in: query
          schema:
            $ref: '#/components/schemas/SocialTrendByDimensionMetric'
        - name: topic_limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 50
        - name: segment_limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 30
      responses:
        '200':
          description: Dataset de distribucion por tema
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MonitorSocialTopicBreakdownResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/monitor/social/targets/er:
    get:
      tags: [Monitor]
      summary: Metas ER por canal para 2026 (auto + overrides)
      parameters:
        - name: year
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 2100
      responses:
        '200':
          description: Metas ER por canal
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MonitorSocialErTargetsResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
    patch:
      tags: [Monitor]
      summary: Actualizar metas ER por canal (solo Admin)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchMonitorSocialErTargetsRequest'
      responses:
        '200':
          description: Metas ER actualizadas
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MonitorSocialErTargetsResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/monitor/social/topics/status:
    get:
      tags: [Monitor]
      summary: Estado de cobertura de clasificacion tematica social
      parameters:
        - name: from
          in: query
          schema:
            type: string
            format: date-time
        - name: to
          in: query
          schema:
            type: string
            format: date-time
      responses:
        '200':
          description: Cobertura de clasificacion de topics
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MonitorSocialTopicsStatusResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/monitor/social/topics/backfill:
    post:
      tags: [Monitor]
      summary: Disparar backfill de clasificacion tematica social (Admin)
      requestBody:
        required: false
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MonitorSocialTopicsBackfillRequest'
      responses:
        '202':
          description: Backfill de topics aceptado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MonitorSocialTopicsBackfillResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/monitor/social/hashtags/backfill:
    post:
      tags: [Monitor]
      summary: Ejecutar backfill idempotente de hashtags historicos
      parameters:
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 50000
            default: 5000
      responses:
        '202':
          description: Backfill aceptado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MonitorSocialHashtagBackfillResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/monitor/social/etl-quality:
    get:
      tags: [Monitor]
      summary: Calidad ETL y reconciliacion S3-DB
      parameters:
        - $ref: '#/components/parameters/Limit'
      responses:
        '200':
          description: Calidad ETL social
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MonitorSocialEtlQualityResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/monitor/social/export.xlsx:
    get:
      tags: [Monitor]
      summary: Export Excel social analytics V2
      parameters:
        - name: preset
          in: query
          schema:
            $ref: '#/components/schemas/SocialDatePreset'
        - name: window_days
          in: query
          schema:
            type: integer
            enum: [7, 30, 90]
        - name: from
          in: query
          schema:
            type: string
            format: date-time
        - name: to
          in: query
          schema:
            type: string
            format: date-time
        - name: channel
          in: query
          schema:
            type: string
          description: Canal o lista CSV de canales (`facebook,instagram,...`)
        - name: account
          in: query
          schema:
            type: string
          description: Cuenta o lista CSV de cuentas
        - name: post_type
          in: query
          schema:
            type: string
          description: Tipo de post o lista CSV de tipos (`unknown` para vacios)
        - name: sentiment
          in: query
          schema:
            $ref: '#/components/schemas/SocialSentiment'
        - name: campaign
          in: query
          schema:
            type: string
          description: Campaña o lista CSV de campañas
        - name: strategy
          in: query
          schema:
            type: string
          description: Estrategia o lista CSV de estrategias
        - name: hashtag
          in: query
          schema:
            type: string
          description: Hashtag o lista CSV de hashtags (con o sin #)
        - name: comparison_mode
          in: query
          schema:
            $ref: '#/components/schemas/SocialComparisonMode'
        - name: comparison_days
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 366
        - name: sort
          in: query
          schema:
            $ref: '#/components/schemas/SocialPostSort'
        - name: min_posts
          in: query
          schema:
            type: integer
            default: 5
        - name: min_exposure
          in: query
          schema:
            type: integer
            default: 5000
      responses:
        '200':
          description: Archivo Excel
          content:
            application/vnd.openxmlformats-officedocument.spreadsheetml.sheet:
              schema:
                type: string
                format: binary
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/monitor/social/runs:
    get:
      tags: [Monitor]
      summary: Historial de corridas de sync social
      parameters:
        - $ref: '#/components/parameters/Cursor'
        - $ref: '#/components/parameters/Limit'
      responses:
        '200':
          description: Corridas sociales
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MonitorSocialRunsResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
    post:
      tags: [Monitor]
      summary: Disparar corrida manual async de sync social
      requestBody:
        required: false
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateMonitorSocialRunRequest'
      responses:
        '202':
          description: Corrida aceptada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MonitorSocialRunAccepted'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/monitor/social/settings:
    get:
      tags: [Monitor]
      summary: Obtener configuracion social de umbrales y metas
      responses:
        '200':
          description: Configuracion social
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MonitorSocialSettings'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
    patch:
      tags: [Monitor]
      summary: Actualizar configuracion social (Admin)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchMonitorSocialSettingsRequest'
      responses:
        '200':
          description: Configuracion actualizada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MonitorSocialSettings'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/monitor/incidents:
    get:
      tags: [Monitor]
      summary: Listado paginado de incidentes operativos
      parameters:
        - $ref: '#/components/parameters/Cursor'
        - $ref: '#/components/parameters/Limit'
        - name: status
          in: query
          schema:
            $ref: '#/components/schemas/IncidentStatus'
        - name: severity
          in: query
          schema:
            $ref: '#/components/schemas/MonitorSeverity'
        - name: scope
          in: query
          schema:
            $ref: '#/components/schemas/TermScope'
        - name: owner_user_id
          in: query
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Lista de incidentes
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/IncidentListResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/monitor/incidents/evaluate:
    post:
      tags: [Monitor]
      summary: Disparar evaluacion manual de incidentes
      responses:
        '202':
          description: Evaluacion encolada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/IncidentEvaluationAccepted'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
  /v1/monitor/incidents/{id}:
    patch:
      tags: [Monitor]
      summary: Actualizar estado, owner y/o nota de un incidente
      parameters:
        - $ref: '#/components/parameters/Id'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchIncidentRequest'
      responses:
        '200':
          description: Incidente actualizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PatchIncidentResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/monitor/incidents/{id}/notes:
    get:
      tags: [Monitor]
      summary: Listar notas de incidente
      parameters:
        - $ref: '#/components/parameters/Id'
        - $ref: '#/components/parameters/Limit'
      responses:
        '200':
          description: Notas del incidente
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/IncidentNotesResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '422':
          $ref: '#/components/responses/ValidationError'
    post:
      tags: [Monitor]
      summary: Agregar nota de incidente
      parameters:
        - $ref: '#/components/parameters/Id'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateIncidentNoteRequest'
      responses:
        '201':
          description: Nota creada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/IncidentNote'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/analyze/overview:
    get:
      tags: [Analysis]
      summary: Overview de analisis con variacion contra periodo anterior
      responses:
        '200':
          description: Resumen de analisis V1 (news-only, ventana fija de 7 dias)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AnalyzeOverviewResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          description: Error interno
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /v1/analyze/channel:
    get:
      tags: [Analysis]
      summary: Analisis por canal/proveedor
      parameters:
        - $ref: '#/components/parameters/Limit'
      responses:
        '200':
          description: Desglose por canal/proveedor
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AnalyzeChannelResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
        '500':
          description: Error interno
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /v1/analyze/competitors:
    get:
      tags: [Analysis]
      summary: Benchmark de competencia sobre set cerrado (scope=competencia)
      parameters:
        - $ref: '#/components/parameters/Limit'
      responses:
        '200':
          description: Benchmark de competidores
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AnalyzeCompetitorsResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
        '500':
          description: Error interno
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /v1/content/{id}/state:
    patch:
      tags: [Content]
      summary: Cambiar estado de un item
      parameters:
        - $ref: '#/components/parameters/Id'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateContentStateRequest'
      responses:
        '200':
          description: Estado actualizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ContentStateEvent'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/content/bulk/state:
    post:
      tags: [Content]
      summary: Cambiar estado de varios items
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BulkUpdateContentStateRequest'
      responses:
        '200':
          description: Resultado de accion masiva
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BulkActionResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/content/{id}/classification:
    patch:
      tags: [Content]
      summary: Override manual de clasificacion
      parameters:
        - $ref: '#/components/parameters/Id'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateClassificationRequest'
      responses:
        '200':
          description: Clasificacion actualizada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Classification'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/analysis/runs:
    post:
      tags: [Analysis]
      summary: Crear corrida async de analisis agregado
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateAnalysisRunRequest'
      responses:
        '202':
          description: Corrida aceptada (nueva o reutilizada por idempotencia)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AnalysisRunAccepted'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/analysis/history:
    get:
      tags: [Analysis]
      summary: Historial de analisis
      parameters:
        - $ref: '#/components/parameters/Cursor'
        - $ref: '#/components/parameters/Limit'
        - name: status
          in: query
          schema:
            $ref: '#/components/schemas/AnalysisRunStatus'
        - name: scope
          in: query
          schema:
            $ref: '#/components/schemas/AnalysisRunScope'
        - name: from
          in: query
          schema:
            type: string
            format: date-time
        - name: to
          in: query
          schema:
            type: string
            format: date-time
      responses:
        '200':
          description: Historial paginado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AnalysisRunListResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/analysis/runs/{id}:
    get:
      tags: [Analysis]
      summary: Detalle de corrida async de analisis
      parameters:
        - $ref: '#/components/parameters/Id'
      responses:
        '200':
          description: Detalle de corrida
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AnalysisRunDetailResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/exports/csv:
    post:
      tags: [Exports]
      summary: Exportar resultados a CSV
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateCsvExportRequest'
      responses:
        '202':
          description: Export en proceso
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ExportAccepted'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/exports/{id}:
    get:
      tags: [Exports]
      summary: Consultar estado de export y URL de descarga
      parameters:
        - $ref: '#/components/parameters/Id'
      responses:
        '200':
          description: Estado actual del export
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ExportStatusResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/reports/center:
    get:
      tags: [Reports]
      summary: Centro de reportes (historial de corridas)
      parameters:
        - $ref: '#/components/parameters/Cursor'
        - $ref: '#/components/parameters/Limit'
        - name: status
          in: query
          schema:
            $ref: '#/components/schemas/ReportRunStatus'
        - name: template_id
          in: query
          schema:
            type: string
            format: uuid
        - name: from
          in: query
          schema:
            type: string
            format: date-time
        - name: to
          in: query
          schema:
            type: string
            format: date-time
      responses:
        '200':
          description: Lista paginada de corridas
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ReportRunListResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/reports/runs/{id}:
    get:
      tags: [Reports]
      summary: Detalle de corrida de reporte
      parameters:
        - $ref: '#/components/parameters/Id'
      responses:
        '200':
          description: Detalle de corrida
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ReportRunDetailResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/reports/runs:
    post:
      tags: [Reports]
      summary: Ejecutar corrida manual de reporte por plantilla
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateReportRunRequest'
      responses:
        '202':
          description: Corrida aceptada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ReportRunAccepted'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/reports/templates:
    get:
      tags: [Reports]
      summary: Listar plantillas de reportes
      parameters:
        - $ref: '#/components/parameters/Limit'
      responses:
        '200':
          description: Lista de plantillas
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ReportTemplatesResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
    post:
      tags: [Reports]
      summary: Crear plantilla de reporte
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateReportTemplateRequest'
      responses:
        '201':
          description: Plantilla creada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ReportTemplate'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/reports/templates/{id}:
    patch:
      tags: [Reports]
      summary: Actualizar plantilla de reporte
      parameters:
        - $ref: '#/components/parameters/Id'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateReportTemplateRequest'
      responses:
        '200':
          description: Plantilla actualizada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ReportTemplate'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/reports/schedules:
    get:
      tags: [Reports]
      summary: Listar schedules de reportes
      parameters:
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 300
            default: 100
      responses:
        '200':
          description: Lista de schedules
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ReportSchedulesResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
    post:
      tags: [Reports]
      summary: Crear schedule de reporte
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateReportScheduleRequest'
      responses:
        '201':
          description: Schedule creado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ReportSchedule'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/reports/schedules/{id}:
    patch:
      tags: [Reports]
      summary: Actualizar schedule de reporte
      parameters:
        - $ref: '#/components/parameters/Id'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateReportScheduleRequest'
      responses:
        '200':
          description: Schedule actualizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ReportSchedule'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/reports/schedules/{id}/run:
    post:
      tags: [Reports]
      summary: Disparar corrida manual para un schedule
      parameters:
        - $ref: '#/components/parameters/Id'
      responses:
        '202':
          description: Corrida aceptada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ReportScheduleRunAccepted'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/meta:
    get:
      tags: [Meta]
      summary: Catalogos de filtros
      responses:
        '200':
          description: Catalogos
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MetaResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
  /v1/connectors:
    get:
      tags: [Connectors]
      summary: Listar configuracion de conectores
      parameters:
        - $ref: '#/components/parameters/Limit'
      responses:
        '200':
          description: Lista de conectores
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConnectorListResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
  /v1/connectors/{id}:
    patch:
      tags: [Connectors]
      summary: Actualizar configuracion de conector
      parameters:
        - $ref: '#/components/parameters/Id'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchConnectorRequest'
      responses:
        '200':
          description: Conector actualizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Connector'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/connectors/{id}/sync:
    post:
      tags: [Connectors]
      summary: Disparar sincronizacion manual de conector
      parameters:
        - $ref: '#/components/parameters/Id'
      responses:
        '202':
          description: Corrida de sincronizacion aceptada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConnectorSyncRun'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/connectors/{id}/runs:
    get:
      tags: [Connectors]
      summary: Historial de corridas de sincronizacion de un conector
      parameters:
        - $ref: '#/components/parameters/Id'
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
      responses:
        '200':
          description: Lista de corridas de sincronizacion
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConnectorRunListResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/config/accounts:
    get:
      tags: [Config]
      summary: Listar cuentas propias monitoreadas
      parameters:
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 300
            default: 200
      responses:
        '200':
          description: Lista de cuentas
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OwnedAccountListResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
    post:
      tags: [Config]
      summary: Crear cuenta propia
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateOwnedAccountRequest'
      responses:
        '201':
          description: Cuenta creada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OwnedAccount'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/config/accounts/{id}:
    patch:
      tags: [Config]
      summary: Actualizar cuenta propia
      parameters:
        - $ref: '#/components/parameters/Id'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateOwnedAccountRequest'
      responses:
        '200':
          description: Cuenta actualizada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OwnedAccount'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/config/awario/profiles:
    get:
      tags: [Config]
      summary: Listar perfiles internos legacy de Awario
      parameters:
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 500
            default: 200
      responses:
        '200':
          description: Lista de perfiles
          headers:
            X-Legacy-Endpoint:
              schema:
                type: string
              description: awario_profiles_internal
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AwarioQueryProfileListResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
    post:
      tags: [Config]
      summary: Crear perfil interno legacy de Awario
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateAwarioQueryProfileRequest'
      responses:
        '201':
          description: Perfil creado
          headers:
            X-Legacy-Endpoint:
              schema:
                type: string
              description: awario_profiles_internal
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AwarioQueryProfile'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/config/awario/profiles/{id}:
    patch:
      tags: [Config]
      summary: Actualizar perfil interno legacy de Awario
      parameters:
        - $ref: '#/components/parameters/Id'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateAwarioQueryProfileRequest'
      responses:
        '200':
          description: Perfil actualizado
          headers:
            X-Legacy-Endpoint:
              schema:
                type: string
              description: awario_profiles_internal
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AwarioQueryProfile'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/config/awario/alerts:
    get:
      tags: [Config]
      summary: Listar alertas remotas disponibles en Awario
      parameters:
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 500
            default: 100
        - name: q
          in: query
          schema:
            type: string
            minLength: 1
            maxLength: 180
        - name: include_inactive
          in: query
          schema:
            type: boolean
            default: false
      responses:
        '200':
          description: Alertas remotas de Awario
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AwarioRemoteAlertListResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/config/awario/alerts/{alert_id}/link:
    post:
      tags: [Config]
      summary: Vincular una alerta remota de Awario y encolar backfill historico
      parameters:
        - name: alert_id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LinkAwarioAlertRequest'
      responses:
        '202':
          description: Alerta vinculada y backfill encolado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LinkAwarioAlertResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/config/awario/bindings:
    get:
      tags: [Config]
      summary: Listar bindings profile -> alert_id de Awario
      parameters:
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 500
            default: 200
      responses:
        '200':
          description: Lista de bindings
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AwarioAlertBindingListResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
    post:
      tags: [Config]
      summary: Crear binding profile -> alert_id de Awario
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateAwarioAlertBindingRequest'
      responses:
        '201':
          description: Binding creado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AwarioAlertBinding'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/config/awario/bindings/{id}:
    patch:
      tags: [Config]
      summary: Actualizar binding profile -> alert_id de Awario
      parameters:
        - $ref: '#/components/parameters/Id'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateAwarioAlertBindingRequest'
      responses:
        '200':
          description: Binding actualizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AwarioAlertBinding'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/config/awario/bindings/{id}/backfill/retry:
    post:
      tags: [Config]
      summary: Reencolar backfill historico para un binding de Awario
      parameters:
        - $ref: '#/components/parameters/Id'
      responses:
        '202':
          description: Backfill reencolado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LinkAwarioAlertResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/config/competitors:
    get:
      tags: [Config]
      summary: Listar competidores
      parameters:
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 300
            default: 200
      responses:
        '200':
          description: Lista de competidores
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CompetitorListResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
    post:
      tags: [Config]
      summary: Crear competidor
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateCompetitorRequest'
      responses:
        '201':
          description: Competidor creado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Competitor'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/config/competitors/{id}:
    patch:
      tags: [Config]
      summary: Actualizar competidor
      parameters:
        - $ref: '#/components/parameters/Id'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateCompetitorRequest'
      responses:
        '200':
          description: Competidor actualizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Competitor'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/config/taxonomies/{kind}:
    get:
      tags: [Config]
      summary: Listar entradas de taxonomia por tipo
      parameters:
        - $ref: '#/components/parameters/TaxonomyKind'
        - name: include_inactive
          in: query
          schema:
            type: boolean
            default: false
      responses:
        '200':
          description: Entradas de taxonomia
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TaxonomyListResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
    post:
      tags: [Config]
      summary: Crear entrada de taxonomia
      parameters:
        - $ref: '#/components/parameters/TaxonomyKind'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateTaxonomyEntryRequest'
      responses:
        '201':
          description: Entrada creada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TaxonomyEntry'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/config/taxonomies/{kind}/{id}:
    patch:
      tags: [Config]
      summary: Actualizar entrada de taxonomia
      parameters:
        - $ref: '#/components/parameters/TaxonomyKind'
        - $ref: '#/components/parameters/Id'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateTaxonomyEntryRequest'
      responses:
        '200':
          description: Entrada actualizada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TaxonomyEntry'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/config/source-scoring/weights:
    get:
      tags: [Config]
      summary: Listar pesos configurables de source scoring
      parameters:
        - name: provider
          in: query
          schema:
            type: string
        - name: include_inactive
          in: query
          schema:
            type: boolean
            default: false
      responses:
        '200':
          description: Pesos configurados
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SourceWeightListResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
    post:
      tags: [Config]
      summary: Crear peso de source scoring
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateSourceWeightRequest'
      responses:
        '201':
          description: Peso creado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SourceWeight'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/config/source-scoring/weights/{id}:
    patch:
      tags: [Config]
      summary: Actualizar peso de source scoring
      parameters:
        - $ref: '#/components/parameters/Id'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateSourceWeightRequest'
      responses:
        '200':
          description: Peso actualizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SourceWeight'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/config/notifications/recipients:
    get:
      tags: [Config]
      summary: Listar recipients de notificaciones (digest/incidentes)
      parameters:
        - name: kind
          in: query
          required: true
          schema:
            $ref: '#/components/schemas/NotificationRecipientKind'
        - name: scope
          in: query
          schema:
            type: string
        - name: include_inactive
          in: query
          schema:
            type: boolean
            default: false
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 500
            default: 200
      responses:
        '200':
          description: Recipients configurados
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotificationRecipientListResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
    post:
      tags: [Config]
      summary: Crear recipient de notificaciones
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateNotificationRecipientRequest'
      responses:
        '201':
          description: Recipient creado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotificationRecipient'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/config/notifications/recipients/{id}:
    patch:
      tags: [Config]
      summary: Actualizar recipient de notificaciones
      parameters:
        - $ref: '#/components/parameters/Id'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateNotificationRecipientRequest'
      responses:
        '200':
          description: Recipient actualizado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotificationRecipient'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/config/notifications/status:
    get:
      tags: [Config]
      summary: Estado SES (sandbox/produccion + sender verificado)
      responses:
        '200':
          description: Estado SES y sender
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotificationEmailStatusResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
  /v1/config/audit:
    get:
      tags: [Audit]
      summary: Listar auditoria de configuracion
      parameters:
        - $ref: '#/components/parameters/Cursor'
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 500
            default: 100
        - name: resource_type
          in: query
          schema:
            type: string
        - name: action
          in: query
          schema:
            type: string
        - name: actor_user_id
          in: query
          schema:
            type: string
            format: uuid
        - name: from
          in: query
          schema:
            type: string
            format: date-time
        - name: to
          in: query
          schema:
            type: string
            format: date-time
      responses:
        '200':
          description: Auditoria paginada
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuditListResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
  /v1/config/audit/export:
    post:
      tags: [Audit]
      summary: Exportar auditoria a CSV (sanitizado por rol)
      requestBody:
        required: false
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateAuditExportRequest'
      responses:
        '202':
          description: Export generado
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuditExportResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  responses:
    Unauthorized:
      description: JWT invalido o ausente
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
    Forbidden:
      description: Rol insuficiente para ejecutar la accion
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
    ValidationError:
      description: Error de validacion de datos de entrada
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
    Conflict:
      description: Conflicto de datos (duplicado/estado invalido)
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
    NotFound:
      description: Recurso no encontrado
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
  parameters:
    Id:
      name: id
      in: path
      required: true
      schema:
        type: string
        format: uuid
    Cursor:
      name: cursor
      in: query
      schema:
        type: string
      description: Cursor opaco para paginacion
    Limit:
      name: limit
      in: query
      schema:
        type: integer
        minimum: 1
        maximum: 200
        default: 50
    TaxonomyKind:
      name: kind
      in: path
      required: true
      schema:
        type: string
        enum: [categories, business_lines, macro_regions, campaigns]
  schemas:
    ErrorResponse:
      type: object
      required: [error, message]
      properties:
        error:
          type: string
        message:
          type: string
    UserRole:
      type: string
      enum: [Admin, Analyst, Viewer]
    SourceType:
      type: string
      enum: [news, social]
    OriginType:
      type: string
      enum: [news, awario]
    ContentTags:
      type: array
      items:
        type: string
    ContentState:
      type: string
      enum: [active, archived, hidden]
    TermScope:
      type: string
      enum: [claro, competencia]
    AnalysisRunScope:
      type: string
      enum: [overview, channel, competitors, custom]
    AnalysisRunStatus:
      type: string
      enum: [queued, running, completed, failed]
    RunStatus:
      type: string
      enum: [queued, running, completed, failed]
    TriggerType:
      type: string
      enum: [scheduled, manual]
    Term:
      type: object
      required: [id, name, scope, is_active, created_at]
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        language:
          type: string
          default: es
        scope:
          $ref: '#/components/schemas/TermScope'
        is_active:
          type: boolean
        schedule:
          type: string
          description: cron/rule de ingestion
        max_articles_per_run:
          type: integer
          default: 100
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
    TermListResponse:
      type: object
      required: [items, page_info]
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/Term'
        page_info:
          $ref: '#/components/schemas/PageInfo'
    CreateTermRequest:
      type: object
      required: [name]
      properties:
        name:
          type: string
          minLength: 2
        language:
          type: string
          default: es
        scope:
          $ref: '#/components/schemas/TermScope'
          default: claro
        max_articles_per_run:
          type: integer
          minimum: 1
          maximum: 500
          default: 100
    UpdateTermRequest:
      type: object
      properties:
        name:
          type: string
        language:
          type: string
        scope:
          $ref: '#/components/schemas/TermScope'
        is_active:
          type: boolean
        max_articles_per_run:
          type: integer
          minimum: 1
          maximum: 500
    QueryExecutionConfig:
      type: object
      required:
        - providers_allow
        - providers_deny
        - countries_allow
        - countries_deny
        - domains_allow
        - domains_deny
      properties:
        providers_allow:
          type: array
          items:
            type: string
        providers_deny:
          type: array
          items:
            type: string
        countries_allow:
          type: array
          items:
            type: string
        countries_deny:
          type: array
          items:
            type: string
        domains_allow:
          type: array
          items:
            type: string
        domains_deny:
          type: array
          items:
            type: string
      additionalProperties: false
    QueryRuleGroup:
      type: object
      required: [kind, op, rules]
      properties:
        kind:
          type: string
          const: group
        op:
          type: string
          enum: [AND, OR]
        rules:
          type: array
          minItems: 1
          items:
            $ref: '#/components/schemas/QueryRule'
      additionalProperties: false
    QueryKeywordRule:
      type: object
      required: [kind, field, match, value]
      properties:
        kind:
          type: string
          const: keyword
        field:
          type: string
          enum: [any, title, summary, content]
        match:
          type: string
          enum: [contains, phrase]
        value:
          type: string
          minLength: 1
          maxLength: 160
        not:
          type: boolean
      additionalProperties: false
    QueryFacetRule:
      type: object
      required: [kind, op, values]
      properties:
        kind:
          type: string
          enum: [provider, language, country, domain]
        op:
          type: string
          enum: [in, not_in]
        values:
          type: array
          minItems: 1
          maxItems: 50
          items:
            type: string
      additionalProperties: false
    QueryRule:
      oneOf:
        - $ref: '#/components/schemas/QueryRuleGroup'
        - $ref: '#/components/schemas/QueryKeywordRule'
        - $ref: '#/components/schemas/QueryFacetRule'
    QueryDefinition:
      $ref: '#/components/schemas/QueryRuleGroup'
    NewsQuery:
      type: object
      required:
        - id
        - name
        - language
        - scope
        - is_active
        - priority
        - max_articles_per_run
        - definition
        - execution
        - compiled_definition
        - current_revision
        - awario_binding_id
        - awario_alert_id
        - awario_link_status
        - awario_sync_state
        - created_at
        - updated_at
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        description:
          type: string
          nullable: true
        language:
          type: string
        scope:
          $ref: '#/components/schemas/TermScope'
        is_active:
          type: boolean
        priority:
          type: integer
          minimum: 1
          maximum: 5
        max_articles_per_run:
          type: integer
          minimum: 1
          maximum: 500
        definition:
          $ref: '#/components/schemas/QueryDefinition'
        execution:
          $ref: '#/components/schemas/QueryExecutionConfig'
        compiled_definition:
          type: object
          additionalProperties: true
        current_revision:
          type: integer
          minimum: 1
        awario_binding_id:
          type: string
          format: uuid
          nullable: true
        awario_alert_id:
          type: string
          nullable: true
        awario_link_status:
          type: string
          enum: [linked, missing_awario]
        awario_sync_state:
          type: string
          nullable: true
          enum: [pending_backfill, backfilling, active, error, paused, archived]
        updated_by_user_id:
          type: string
          format: uuid
          nullable: true
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
    ConfigQueryListResponse:
      type: object
      required: [items, page_info]
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/NewsQuery'
        page_info:
          $ref: '#/components/schemas/PageInfo'
    CreateConfigQueryRequest:
      type: object
      required: [name, awario_alert_id]
      properties:
        name:
          type: string
          minLength: 2
          maxLength: 160
        awario_alert_id:
          type: string
          minLength: 1
          maxLength: 180
        description:
          type: string
          nullable: true
          maxLength: 600
        language:
          type: string
          default: es
        scope:
          $ref: '#/components/schemas/TermScope'
          default: claro
        is_active:
          type: boolean
          default: true
        priority:
          type: integer
          minimum: 1
          maximum: 5
          default: 3
        max_articles_per_run:
          type: integer
          minimum: 1
          maximum: 500
          default: 100
        definition:
          $ref: '#/components/schemas/QueryDefinition'
        execution:
          $ref: '#/components/schemas/QueryExecutionConfig'
        change_reason:
          type: string
          nullable: true
          maxLength: 240
      additionalProperties: false
    UpdateConfigQueryRequest:
      type: object
      minProperties: 1
      properties:
        awario_alert_id:
          type: string
          minLength: 1
          maxLength: 180
        name:
          type: string
          minLength: 2
          maxLength: 160
        description:
          type: string
          nullable: true
          maxLength: 600
        language:
          type: string
        scope:
          $ref: '#/components/schemas/TermScope'
        is_active:
          type: boolean
        priority:
          type: integer
          minimum: 1
          maximum: 5
        max_articles_per_run:
          type: integer
          minimum: 1
          maximum: 500
        definition:
          $ref: '#/components/schemas/QueryDefinition'
        execution:
          $ref: '#/components/schemas/QueryExecutionConfig'
        change_reason:
          type: string
          nullable: true
          maxLength: 240
      additionalProperties: false
    ConfigQueryDeleteResponse:
      type: object
      required: [ok, id]
      properties:
        ok:
          type: boolean
          const: true
        id:
          type: string
          format: uuid
    ConfigQueryRevision:
      type: object
      required:
        - id
        - query_id
        - revision
        - definition
        - execution
        - compiled_definition
        - created_at
      properties:
        id:
          type: string
          format: uuid
        query_id:
          type: string
          format: uuid
        revision:
          type: integer
          minimum: 1
        definition:
          $ref: '#/components/schemas/QueryDefinition'
        execution:
          $ref: '#/components/schemas/QueryExecutionConfig'
        compiled_definition:
          type: object
          additionalProperties: true
        changed_by_user_id:
          type: string
          format: uuid
          nullable: true
        change_reason:
          type: string
          nullable: true
        created_at:
          type: string
          format: date-time
    ConfigQueryRevisionListResponse:
      type: object
      required: [query_id, items]
      properties:
        query_id:
          type: string
          format: uuid
        items:
          type: array
          items:
            $ref: '#/components/schemas/ConfigQueryRevision'
    ConfigQueryRollbackRequest:
      type: object
      required: [revision]
      properties:
        revision:
          type: integer
          minimum: 1
        change_reason:
          type: string
          nullable: true
          maxLength: 240
      additionalProperties: false
    ConfigQueryPreviewRequest:
      type: object
      required: [definition]
      properties:
        definition:
          $ref: '#/components/schemas/QueryDefinition'
        execution:
          $ref: '#/components/schemas/QueryExecutionConfig'
        limit:
          type: integer
          minimum: 1
          maximum: 50
          default: 20
        candidate_limit:
          type: integer
          minimum: 1
          maximum: 2000
          default: 500
      additionalProperties: false
    ConfigQueryPreviewItem:
      type: object
      required: [content_item_id, origin, medium, tags, provider, title, canonical_url, published_at]
      properties:
        content_item_id:
          type: string
          format: uuid
        origin:
          $ref: '#/components/schemas/OriginType'
        medium:
          type: string
          nullable: true
        tags:
          $ref: '#/components/schemas/ContentTags'
        provider:
          type: string
        title:
          type: string
        canonical_url:
          type: string
          format: uri
        published_at:
          type: string
          format: date-time
          nullable: true
    ConfigQueryProviderBreakdown:
      type: object
      required: [provider, count]
      properties:
        provider:
          type: string
        count:
          type: integer
          minimum: 0
    ConfigQueryPreviewResponse:
      type: object
      required: [matched_count, candidates_count, sample, provider_breakdown]
      properties:
        matched_count:
          type: integer
          minimum: 0
        candidates_count:
          type: integer
          minimum: 0
        sample:
          type: array
          items:
            $ref: '#/components/schemas/ConfigQueryPreviewItem'
        provider_breakdown:
          type: array
          items:
            $ref: '#/components/schemas/ConfigQueryProviderBreakdown'
    ConfigQueryDryRunRequest:
      type: object
      properties:
        max_articles_per_term:
          type: integer
          minimum: 1
          maximum: 500
      additionalProperties: false
    ConfigQueryDryRunProviderResult:
      type: object
      required: [provider, raw_count, fetched_count, matched_count, duration_ms]
      properties:
        provider:
          type: string
        request_url:
          type: string
          nullable: true
        raw_count:
          type: integer
          minimum: 0
        fetched_count:
          type: integer
          minimum: 0
        matched_count:
          type: integer
          minimum: 0
        duration_ms:
          type: integer
          minimum: 0
        error_type:
          type: string
          nullable: true
        error:
          type: string
          nullable: true
    ConfigQueryDryRunTotals:
      type: object
      required: [raw_count, fetched_count, matched_count, origin_breakdown]
      properties:
        raw_count:
          type: integer
          minimum: 0
        fetched_count:
          type: integer
          minimum: 0
        matched_count:
          type: integer
          minimum: 0
        origin_breakdown:
          type: object
          additionalProperties:
            type: integer
            minimum: 0
    ConfigQueryDryRunSampleItem:
      type: object
      required: [origin, medium, tags, provider, title, canonical_url]
      properties:
        origin:
          $ref: '#/components/schemas/OriginType'
        medium:
          type: string
          nullable: true
        tags:
          $ref: '#/components/schemas/ContentTags'
        provider:
          type: string
        title:
          type: string
        canonical_url:
          type: string
          format: uri
        published_at:
          type: string
          format: date-time
          nullable: true
    ConfigQueryDryRunResponse:
      type: object
      required:
        - run_id
        - query_id
        - providers_used
        - query_text
        - requested_max_articles_per_term
        - effective_max_articles_per_term
        - providers
        - totals
        - sample
      properties:
        run_id:
          type: string
          format: uuid
        query_id:
          type: string
          format: uuid
        providers_used:
          type: array
          items:
            type: string
        query_text:
          type: string
        requested_max_articles_per_term:
          type: integer
          minimum: 1
        effective_max_articles_per_term:
          type: integer
          minimum: 1
        providers:
          type: array
          items:
            $ref: '#/components/schemas/ConfigQueryDryRunProviderResult'
        totals:
          $ref: '#/components/schemas/ConfigQueryDryRunTotals'
        sample:
          type: array
          items:
            $ref: '#/components/schemas/ConfigQueryDryRunSampleItem'
    ContentItem:
      type: object
      required: [id, source_type, origin, medium, tags, state, title, canonical_url, created_at]
      properties:
        id:
          type: string
          format: uuid
        source_type:
          $ref: '#/components/schemas/SourceType'
        origin:
          $ref: '#/components/schemas/OriginType'
        medium:
          type: string
          nullable: true
        tags:
          $ref: '#/components/schemas/ContentTags'
        term_id:
          type: string
          format: uuid
        provider:
          type: string
        source_name:
          type: string
        source_id:
          type: string
        state:
          $ref: '#/components/schemas/ContentState'
        title:
          type: string
        summary:
          type: string
        content:
          type: string
        canonical_url:
          type: string
          format: uri
        image_url:
          type: string
          format: uri
        language:
          type: string
        category:
          type: string
        published_at:
          type: string
          format: date-time
        source_score:
          type: number
          minimum: 0
          maximum: 1
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
        raw_payload_s3_key:
          type: string
        categoria:
          type: string
        sentimiento:
          type: string
    Classification:
      type: object
      required: [id, content_item_id, categoria, sentimiento, prompt_version, model_id, created_at]
      properties:
        id:
          type: string
          format: uuid
        content_item_id:
          type: string
          format: uuid
        categoria:
          type: string
        sentimiento:
          type: string
        etiquetas:
          type: array
          items:
            type: string
        confianza:
          type: number
          minimum: 0
          maximum: 1
        override_by:
          type: string
          format: uuid
        prompt_version:
          type: string
        model_id:
          type: string
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
    ContentStateEvent:
      type: object
      required: [id, content_item_id, previous_state, next_state, actor_user_id, created_at]
      properties:
        id:
          type: string
          format: uuid
        content_item_id:
          type: string
          format: uuid
        previous_state:
          $ref: '#/components/schemas/ContentState'
        next_state:
          $ref: '#/components/schemas/ContentState'
        actor_user_id:
          type: string
          format: uuid
        reason:
          type: string
        created_at:
          type: string
          format: date-time
    CreateIngestionRunRequest:
      type: object
      properties:
        run_id:
          type: string
          format: uuid
        terms:
          type: array
          items:
            type: string
        term_ids:
          type: array
          items:
            type: string
            format: uuid
        language:
          type: string
          default: es
        max_articles_per_term:
          type: integer
          minimum: 1
          maximum: 500
          default: 100
          description: Valor solicitado; para `source_type=news` el valor efectivo aplicado por runtime es 2.
    IngestionRunAccepted:
      type: object
      required: [run_id, status, input]
      properties:
        run_id:
          type: string
          format: uuid
        status:
          type: string
          const: accepted
        execution_arn:
          type: string
          nullable: true
        start_date:
          type: string
          format: date-time
          nullable: true
        skip_reason:
          type: string
          nullable: true
        input:
          type: object
          properties:
            triggerType:
              type: string
            runId:
              type: string
              format: uuid
            requestId:
              type: string
            requestedAt:
              type: string
              format: date-time
            termIds:
              type: array
              items:
                type: string
                format: uuid
            terms:
              type: array
              items:
                type: string
            language:
              type: string
            maxArticlesPerTerm:
              type: integer
              description: Valor efectivo aplicado por runtime (news fijo en 2).
            requestedMaxArticlesPerTerm:
              type: integer
              description: Valor solicitado por el cliente antes de aplicar politicas de limite.
    UpdateContentStateRequest:
      type: object
      required: [target_state]
      properties:
        target_state:
          $ref: '#/components/schemas/ContentState'
        reason:
          type: string
    BulkUpdateContentStateRequest:
      type: object
      required: [ids, target_state]
      properties:
        ids:
          type: array
          minItems: 1
          items:
            type: string
            format: uuid
        target_state:
          $ref: '#/components/schemas/ContentState'
        reason:
          type: string
    BulkActionResponse:
      type: object
      required: [processed, failed]
      properties:
        processed:
          type: integer
        failed:
          type: integer
        failures:
          type: array
          items:
            type: object
            properties:
              id:
                type: string
                format: uuid
              error:
                type: string
              message:
                type: string
    UpdateClassificationRequest:
      type: object
      required: [categoria, sentimiento]
      properties:
        categoria:
          type: string
        sentimiento:
          type: string
        etiquetas:
          type: array
          items:
            type: string
        confidence_override:
          type: number
          minimum: 0
          maximum: 1
        reason:
          type: string
    CreateAnalysisRunRequest:
      type: object
      required: [scope]
      properties:
        scope:
          $ref: '#/components/schemas/AnalysisRunScope'
        source_type:
          $ref: '#/components/schemas/SourceType'
          default: news
        trigger_type:
          type: string
          enum: [manual, scheduled]
          default: manual
        model_id:
          type: string
          minLength: 8
        prompt_version:
          type: string
          default: analysis-v1
        idempotency_key:
          type: string
          maxLength: 200
          nullable: true
        filters:
          type: object
          properties:
            term_id:
              type: string
              format: uuid
            provider:
              type: string
            category:
              type: string
            sentimiento:
              type: string
            q:
              type: string
            from:
              type: string
              format: date-time
            to:
              type: string
              format: date-time
          additionalProperties: false
        content_ids:
          type: array
          items:
            type: string
            format: uuid
        limit:
          type: integer
          minimum: 1
          maximum: 500
          default: 120
    AnalysisRunAccepted:
      type: object
      required: [analysis_run_id, status, reused, input_count, idempotency_key]
      properties:
        analysis_run_id:
          type: string
          format: uuid
        status:
          type: string
          const: accepted
        reused:
          type: boolean
        input_count:
          type: integer
          minimum: 0
        idempotency_key:
          type: string
    AnalysisRun:
      type: object
      required:
        - id
        - scope
        - status
        - trigger_type
        - source_type
        - input_count
        - model_id
        - prompt_version
        - filters
        - window_start
        - window_end
        - created_at
        - updated_at
      properties:
        id:
          type: string
          format: uuid
        scope:
          $ref: '#/components/schemas/AnalysisRunScope'
        status:
          $ref: '#/components/schemas/AnalysisRunStatus'
        trigger_type:
          type: string
          enum: [manual, scheduled]
        source_type:
          $ref: '#/components/schemas/SourceType'
        input_count:
          type: integer
        model_id:
          type: string
        prompt_version:
          type: string
        filters:
          type: object
          additionalProperties: true
        output:
          type: object
          additionalProperties: true
          nullable: true
        request_id:
          type: string
          nullable: true
        requested_by_user_id:
          type: string
          format: uuid
          nullable: true
        requested_by_name:
          type: string
          nullable: true
        requested_by_email:
          type: string
          nullable: true
        idempotency_key:
          type: string
          nullable: true
        window_start:
          type: string
          format: date-time
        window_end:
          type: string
          format: date-time
        error_message:
          type: string
          nullable: true
        started_at:
          type: string
          format: date-time
          nullable: true
        completed_at:
          type: string
          format: date-time
          nullable: true
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
    AnalysisRunListResponse:
      type: object
      required: [items, page_info]
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/AnalysisRun'
        page_info:
          $ref: '#/components/schemas/PageInfo'
    AnalysisRunDetailResponse:
      type: object
      required: [run, input_summary]
      properties:
        run:
          $ref: '#/components/schemas/AnalysisRun'
        input_summary:
          type: object
          required: [input_count, sample_content_ids, sample_size]
          properties:
            input_count:
              type: integer
            sample_content_ids:
              type: array
              items:
                type: string
                format: uuid
            sample_size:
              type: integer
        output:
          type: object
          additionalProperties: true
          nullable: true
        error:
          type: string
          nullable: true
    CreateCsvExportRequest:
      type: object
      properties:
        filters:
          type: object
          properties:
            state:
              $ref: '#/components/schemas/ContentState'
            source_type:
              $ref: '#/components/schemas/SourceType'
            term_id:
              type: string
              format: uuid
            provider:
              type: string
            category:
              type: string
            sentimiento:
              type: string
            from:
              type: string
              format: date-time
            to:
              type: string
              format: date-time
            q:
              type: string
          additionalProperties: false
    ExportAccepted:
      type: object
      required: [export_id, status]
      properties:
        export_id:
          type: string
          format: uuid
        status:
          type: string
          const: accepted
    ExportStatusResponse:
      type: object
      required: [export_id, status, row_count, created_at]
      properties:
        export_id:
          type: string
          format: uuid
        status:
          type: string
          enum: [queued, running, completed, failed]
        row_count:
          type: integer
        created_at:
          type: string
          format: date-time
        completed_at:
          type: string
          format: date-time
          nullable: true
        download_url:
          type: string
          format: uri
          nullable: true
        filters:
          type: object
          additionalProperties: true
    ReportRunStatus:
      type: string
      enum: [queued, running, completed, failed, pending_review]
    ReportScheduleFrequency:
      type: string
      enum: [daily, weekly]
    ReportTemplate:
      type: object
      required: [id, name, is_active, confidence_threshold, created_at, updated_at]
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        description:
          type: string
          nullable: true
        is_active:
          type: boolean
        sections:
          type: object
          additionalProperties: true
        filters:
          type: object
          additionalProperties: true
        confidence_threshold:
          type: number
          minimum: 0
          maximum: 1
        created_by_user_id:
          type: string
          format: uuid
          nullable: true
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
    ReportSchedule:
      type: object
      required: [id, template_id, template_name, name, enabled, frequency, time_local, timezone, next_run_at, created_at, updated_at]
      properties:
        id:
          type: string
          format: uuid
        template_id:
          type: string
          format: uuid
        template_name:
          type: string
        name:
          type: string
        enabled:
          type: boolean
        frequency:
          $ref: '#/components/schemas/ReportScheduleFrequency'
        day_of_week:
          type: integer
          minimum: 0
          maximum: 6
          nullable: true
        time_local:
          type: string
          pattern: '^\\d{2}:\\d{2}$'
        timezone:
          type: string
        recipients:
          type: array
          items:
            type: string
            format: email
        next_run_at:
          type: string
          format: date-time
        last_run_at:
          type: string
          format: date-time
          nullable: true
        created_by_user_id:
          type: string
          format: uuid
          nullable: true
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
    ReportRun:
      type: object
      required: [id, template_id, template_name, status, window_start, window_end, source_type, created_at]
      properties:
        id:
          type: string
          format: uuid
        template_id:
          type: string
          format: uuid
        template_name:
          type: string
        schedule_id:
          type: string
          format: uuid
          nullable: true
        schedule_name:
          type: string
          nullable: true
        status:
          $ref: '#/components/schemas/ReportRunStatus'
        window_start:
          type: string
          format: date-time
        window_end:
          type: string
          format: date-time
        source_type:
          $ref: '#/components/schemas/SourceType'
        confidence:
          type: number
          minimum: 0
          maximum: 1
          nullable: true
        summary:
          type: object
          additionalProperties: true
        recommendations:
          type: array
          items:
            type: string
        blocked_reason:
          type: string
          nullable: true
        export_job_id:
          type: string
          format: uuid
          nullable: true
        export_status:
          type: string
          enum: [queued, running, completed, failed]
          nullable: true
        download_url:
          type: string
          format: uri
          nullable: true
        requested_by_user_id:
          type: string
          format: uuid
          nullable: true
        requested_by_name:
          type: string
          nullable: true
        requested_by_email:
          type: string
          format: email
          nullable: true
        idempotency_key:
          type: string
          nullable: true
        created_at:
          type: string
          format: date-time
        started_at:
          type: string
          format: date-time
          nullable: true
        completed_at:
          type: string
          format: date-time
          nullable: true
        error_message:
          type: string
          nullable: true
    ReportRunListResponse:
      type: object
      required: [items, page_info]
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/ReportRun'
        page_info:
          $ref: '#/components/schemas/PageInfo'
    ReportRunDetailResponse:
      type: object
      required: [run, template]
      properties:
        run:
          $ref: '#/components/schemas/ReportRun'
        template:
          $ref: '#/components/schemas/ReportTemplate'
        schedule:
          oneOf:
            - $ref: '#/components/schemas/ReportSchedule'
            - type: 'null'
    ReportTemplatesResponse:
      type: object
      required: [items]
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/ReportTemplate'
    ReportSchedulesResponse:
      type: object
      required: [items]
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/ReportSchedule'
    CreateReportRunRequest:
      type: object
      required: [template_id]
      properties:
        template_id:
          type: string
          format: uuid
    ReportRunAccepted:
      type: object
      required: [report_run_id, status]
      properties:
        report_run_id:
          type: string
          format: uuid
        status:
          type: string
          const: queued
    ReportScheduleRunAccepted:
      type: object
      required: [report_run_id, schedule_id, status]
      properties:
        report_run_id:
          type: string
          format: uuid
        schedule_id:
          type: string
          format: uuid
        status:
          type: string
          const: queued
    CreateReportTemplateRequest:
      type: object
      required: [name]
      properties:
        name:
          type: string
          minLength: 3
          maxLength: 120
        description:
          type: string
          maxLength: 600
        is_active:
          type: boolean
          default: true
        sections:
          type: object
          additionalProperties: true
        filters:
          type: object
          additionalProperties: true
        confidence_threshold:
          type: number
          minimum: 0
          maximum: 1
          default: 0.65
    UpdateReportTemplateRequest:
      type: object
      properties:
        name:
          type: string
          minLength: 3
          maxLength: 120
        description:
          type: string
          maxLength: 600
          nullable: true
        is_active:
          type: boolean
        sections:
          type: object
          additionalProperties: true
        filters:
          type: object
          additionalProperties: true
        confidence_threshold:
          type: number
          minimum: 0
          maximum: 1
    CreateReportScheduleRequest:
      type: object
      required: [template_id, name, frequency, time_local]
      properties:
        template_id:
          type: string
          format: uuid
        name:
          type: string
          minLength: 3
          maxLength: 120
        enabled:
          type: boolean
          default: true
        frequency:
          $ref: '#/components/schemas/ReportScheduleFrequency'
        day_of_week:
          type: integer
          minimum: 0
          maximum: 6
          nullable: true
        time_local:
          type: string
          pattern: '^\\d{2}:\\d{2}$'
        timezone:
          type: string
          default: America/Bogota
        recipients:
          type: array
          items:
            type: string
            format: email
    UpdateReportScheduleRequest:
      type: object
      properties:
        name:
          type: string
          minLength: 3
          maxLength: 120
        enabled:
          type: boolean
        frequency:
          $ref: '#/components/schemas/ReportScheduleFrequency'
        day_of_week:
          type: integer
          minimum: 0
          maximum: 6
          nullable: true
        time_local:
          type: string
          pattern: '^\\d{2}:\\d{2}$'
        timezone:
          type: string
        recipients:
          type: array
          items:
            type: string
            format: email
    MonitorSeverity:
      type: string
      enum: [SEV1, SEV2, SEV3, SEV4]
    IncidentStatus:
      type: string
      enum: [open, acknowledged, in_progress, resolved, dismissed]
    MonitorScopeKpi:
      type: object
      required:
        [items, classified_items, positivos, negativos, neutrales, sentimiento_neto, riesgo_activo, quality_score, bhs, sov, insufficient_data]
      properties:
        items:
          type: integer
        classified_items:
          type: integer
        positivos:
          type: integer
        negativos:
          type: integer
        neutrales:
          type: integer
        sentimiento_neto:
          type: number
        riesgo_activo:
          type: number
        quality_score:
          type: number
        bhs:
          type: number
        sov:
          type: number
        insufficient_data:
          type: boolean
    MonitorTotalsKpi:
      type: object
      required: [items, classified_items, sentimiento_neto, bhs, riesgo_activo, severidad, sov_claro, sov_competencia, insufficient_data]
      properties:
        items:
          type: integer
        classified_items:
          type: integer
        sentimiento_neto:
          type: number
        bhs:
          type: number
        riesgo_activo:
          type: number
        severidad:
          $ref: '#/components/schemas/MonitorSeverity'
        sov_claro:
          type: number
        sov_competencia:
          type: number
        insufficient_data:
          type: boolean
    MonitorDiagnostics:
      type: object
      required: [unscoped_items, unknown_sentiment_items]
      properties:
        unscoped_items:
          type: integer
        unknown_sentiment_items:
          type: integer
    MonitorOverviewResponse:
      type: object
      required: [generated_at, window_days, source_type, formula_version, totals, by_scope, diagnostics]
      properties:
        generated_at:
          type: string
          format: date-time
        window_days:
          type: integer
          const: 7
        source_type:
          type: string
          const: news
        formula_version:
          type: string
          const: kpi-v1
        totals:
          $ref: '#/components/schemas/MonitorTotalsKpi'
        by_scope:
          type: object
          required: [claro, competencia]
          properties:
            claro:
              $ref: '#/components/schemas/MonitorScopeKpi'
            competencia:
              $ref: '#/components/schemas/MonitorScopeKpi'
        diagnostics:
          $ref: '#/components/schemas/MonitorDiagnostics'
    SocialChannel:
      type: string
      enum: [facebook, instagram, linkedin, tiktok]
    SocialSentiment:
      type: string
      enum: [positive, negative, neutral, unknown]
    SocialDatePreset:
      type: string
      enum: [all, y2024, y2025, ytd, 90d, 30d, 7d, last_quarter, custom]
    SocialComparisonMode:
      type: string
      enum: [weekday_aligned_week, exact_days, same_period_last_year]
    SocialHeatmapMetric:
      type: string
      enum: [er, engagement_total, likes, comments, shares, views, view_rate, impressions, reach, clicks, ctr, er_impressions, er_reach]
    SocialScatterDimension:
      type: string
      enum: [post_type, channel, account, campaign, strategy, hashtag]
    SocialTopicBreakdownDimension:
      type: string
      enum: [post_type, channel, account, campaign, strategy, hashtag]
    SocialTrendByDimensionMetric:
      type: string
      enum:
        [
          posts,
          exposure_total,
          engagement_total,
          impressions_total,
          reach_total,
          clicks_total,
          likes_total,
          comments_total,
          shares_total,
          views_total,
          er_global,
          ctr,
          er_impressions,
          er_reach,
          view_rate,
          likes_share,
          comments_share,
          shares_share,
          riesgo_activo,
          shs
        ]
    SocialErBreakdownDimension:
      type: string
      enum: [hashtag, word, post_type, publish_frequency, weekday]
    SocialTrendGranularity:
      type: string
      enum: [auto, day, week, month]
    SocialPostSort:
      type: string
      enum: [published_at_desc, exposure_desc, engagement_desc]
    SocialAccountsSort:
      type: string
      enum: [er_desc, exposure_desc, engagement_desc, posts_desc, riesgo_desc, sov_desc, account_asc]
    SocialReconciliationStatus:
      type: string
      enum: [ok, warning, error, unknown]
    SocialSyncPhase:
      type: string
      enum: [ingest, classify, aggregate, reconcile, alerts]
    SocialSyncPhaseState:
      type: string
      enum: [pending, running, completed, failed, skipped]
    SocialRunCounters:
      type: object
      required:
        [
          objects_discovered,
          objects_processed,
          objects_skipped,
          rows_parsed,
          rows_persisted,
          rows_classified,
          rows_pending_classification,
          rows_unknown_sentiment,
          malformed_rows,
          anomalous_object_keys
        ]
      properties:
        objects_discovered:
          type: integer
        objects_processed:
          type: integer
        objects_skipped:
          type: integer
        rows_parsed:
          type: integer
        rows_persisted:
          type: integer
        rows_classified:
          type: integer
        rows_pending_classification:
          type: integer
        rows_unknown_sentiment:
          type: integer
        malformed_rows:
          type: integer
        anomalous_object_keys:
          type: integer
    MonitorSocialKpis:
      type: object
      required:
        [
          posts,
          exposure_total,
          engagement_total,
          er_global,
          classified_items,
          positivos,
          negativos,
          neutrales,
          sentimiento_neto,
          riesgo_activo,
          shs,
          focus_account,
          focus_account_sov
        ]
      properties:
        posts:
          type: integer
        exposure_total:
          type: number
        engagement_total:
          type: number
        impressions_total:
          type: number
        reach_total:
          type: number
        clicks_total:
          type: number
        likes_total:
          type: number
        comments_total:
          type: number
        shares_total:
          type: number
        views_total:
          type: number
        er_global:
          type: number
        ctr:
          type: number
        er_impressions:
          type: number
        er_reach:
          type: number
        view_rate:
          type: number
        likes_share:
          type: number
        comments_share:
          type: number
        shares_share:
          type: number
        classified_items:
          type: integer
        positivos:
          type: integer
        negativos:
          type: integer
        neutrales:
          type: integer
        sentimiento_neto:
          type: number
        riesgo_activo:
          type: number
        shs:
          type: number
        focus_account:
          type: string
          nullable: true
        focus_account_sov:
          type: number
    MonitorSocialDelta:
      type: object
      required:
        [posts, exposure_total, engagement_total, er_global, sentimiento_neto, riesgo_activo, shs, focus_account_sov]
      properties:
        posts:
          type: number
        exposure_total:
          type: number
        engagement_total:
          type: number
        impressions_total:
          type: number
        reach_total:
          type: number
        clicks_total:
          type: number
        likes_total:
          type: number
        comments_total:
          type: number
        shares_total:
          type: number
        views_total:
          type: number
        er_global:
          type: number
        ctr:
          type: number
        er_impressions:
          type: number
        er_reach:
          type: number
        view_rate:
          type: number
        likes_share:
          type: number
        comments_share:
          type: number
        shares_share:
          type: number
        sentimiento_neto:
          type: number
        riesgo_activo:
          type: number
        shs:
          type: number
        focus_account_sov:
          type: number
    MonitorSocialComparison:
      type: object
      required: [mode_applied, current_window_start, current_window_end, previous_window_start, previous_window_end, label]
      properties:
        mode_applied:
          $ref: '#/components/schemas/SocialComparisonMode'
        current_window_start:
          type: string
          format: date-time
        current_window_end:
          type: string
          format: date-time
        previous_window_start:
          type: string
          format: date-time
        previous_window_end:
          type: string
          format: date-time
        label:
          type: string
    MonitorSocialPreviousPeriod:
      type: object
      required: [posts, exposure_total, engagement_total, er_global, sentimiento_neto, riesgo_activo, shs, focus_account_sov]
      properties:
        posts:
          type: number
        exposure_total:
          type: number
        engagement_total:
          type: number
        impressions_total:
          type: number
        reach_total:
          type: number
        clicks_total:
          type: number
        likes_total:
          type: number
        comments_total:
          type: number
        shares_total:
          type: number
        views_total:
          type: number
        er_global:
          type: number
        ctr:
          type: number
        er_impressions:
          type: number
        er_reach:
          type: number
        view_rate:
          type: number
        likes_share:
          type: number
        comments_share:
          type: number
        shares_share:
          type: number
        sentimiento_neto:
          type: number
        riesgo_activo:
          type: number
        shs:
          type: number
        focus_account_sov:
          type: number
    MonitorSocialErTargetProgressItem:
      type: object
      required: [channel, baseline_2025_er, target_2026_er, current_er, gap, progress_pct, source]
      properties:
        channel:
          $ref: '#/components/schemas/SocialChannel'
        baseline_2025_er:
          type: number
        target_2026_er:
          type: number
        current_er:
          type: number
        gap:
          type: number
        progress_pct:
          type: number
        source:
          type: string
          enum: [auto, manual]
    MonitorSocialTargetProgress:
      type: object
      required:
        [quarterly_sov_target_pp, quarterly_sov_delta_pp, quarterly_sov_progress_pct, target_shs, shs_gap, shs_progress_pct, er_by_channel]
      properties:
        quarterly_sov_target_pp:
          type: number
        quarterly_sov_delta_pp:
          type: number
        quarterly_sov_progress_pct:
          type: number
        target_shs:
          type: number
        shs_gap:
          type: number
        shs_progress_pct:
          type: number
        er_by_channel:
          type: array
          items:
            $ref: '#/components/schemas/MonitorSocialErTargetProgressItem'
    MonitorSocialTrendItem:
      type: object
      required: [date, posts, exposure_total, engagement_total, er_global, sentimiento_neto, riesgo_activo]
      properties:
        date:
          type: string
        posts:
          type: integer
        exposure_total:
          type: number
        engagement_total:
          type: number
        impressions_total:
          type: number
        reach_total:
          type: number
        clicks_total:
          type: number
        likes_total:
          type: number
        comments_total:
          type: number
        shares_total:
          type: number
        views_total:
          type: number
        er_global:
          type: number
        ctr:
          type: number
        er_impressions:
          type: number
        er_reach:
          type: number
        view_rate:
          type: number
        likes_share:
          type: number
        comments_share:
          type: number
        shares_share:
          type: number
        sentimiento_neto:
          type: number
        riesgo_activo:
          type: number
    MonitorSocialTrendSeriesItem:
      type: object
      required: [bucket_start, bucket_end, bucket_label, posts, exposure_total, engagement_total, er_global, sentimiento_neto, riesgo_activo, shs]
      properties:
        bucket_start:
          type: string
          format: date-time
        bucket_end:
          type: string
          format: date-time
        bucket_label:
          type: string
        posts:
          type: integer
        exposure_total:
          type: number
        engagement_total:
          type: number
        impressions_total:
          type: number
        reach_total:
          type: number
        clicks_total:
          type: number
        likes_total:
          type: number
        comments_total:
          type: number
        shares_total:
          type: number
        views_total:
          type: number
        er_global:
          type: number
        ctr:
          type: number
        er_impressions:
          type: number
        er_reach:
          type: number
        view_rate:
          type: number
        likes_share:
          type: number
        comments_share:
          type: number
        shares_share:
          type: number
        sentimiento_neto:
          type: number
        riesgo_activo:
          type: number
        shs:
          type: number
    MonitorSocialByChannelItem:
      type: object
      required: [channel, posts, exposure_total, engagement_total, er_global, sentimiento_neto, riesgo_activo, sov_interno]
      properties:
        channel:
          $ref: '#/components/schemas/SocialChannel'
        posts:
          type: integer
        exposure_total:
          type: number
        engagement_total:
          type: number
        impressions_total:
          type: number
        reach_total:
          type: number
        clicks_total:
          type: number
        likes_total:
          type: number
        comments_total:
          type: number
        shares_total:
          type: number
        views_total:
          type: number
        er_global:
          type: number
        ctr:
          type: number
        er_impressions:
          type: number
        er_reach:
          type: number
        view_rate:
          type: number
        likes_share:
          type: number
        comments_share:
          type: number
        shares_share:
          type: number
        sentimiento_neto:
          type: number
        riesgo_activo:
          type: number
        sov_interno:
          type: number
    MonitorSocialByAccountItem:
      type: object
      required:
        [account_name, channel_mix, posts, exposure_total, engagement_total, er_global, sentimiento_neto, riesgo_activo, sov_interno]
      properties:
        account_name:
          type: string
        channel_mix:
          type: array
          items:
            $ref: '#/components/schemas/SocialChannel'
        posts:
          type: integer
        exposure_total:
          type: number
        engagement_total:
          type: number
        impressions_total:
          type: number
        reach_total:
          type: number
        clicks_total:
          type: number
        likes_total:
          type: number
        comments_total:
          type: number
        shares_total:
          type: number
        views_total:
          type: number
        er_global:
          type: number
        ctr:
          type: number
        er_impressions:
          type: number
        er_reach:
          type: number
        view_rate:
          type: number
        likes_share:
          type: number
        comments_share:
          type: number
        shares_share:
          type: number
        sentimiento_neto:
          type: number
        riesgo_activo:
          type: number
        sov_interno:
          type: number
    MonitorSocialDiagnostics:
      type: object
      required:
        [
          insufficient_data,
          unclassified_items,
          unknown_sentiment_items,
          last_run_status,
          processed_objects,
          anomalous_object_keys,
          rows_pending_classification,
          window_start,
          window_end
        ]
      properties:
        insufficient_data:
          type: boolean
        unclassified_items:
          type: integer
        unknown_sentiment_items:
          type: integer
        last_run_status:
          type: string
          nullable: true
        processed_objects:
          type: integer
        anomalous_object_keys:
          type: integer
        rows_pending_classification:
          type: integer
        window_start:
          type: string
          format: date-time
        window_end:
          type: string
          format: date-time
    MonitorSocialCoverage:
      type: object
      required: [db_min_date, db_max_date, s3_min_date, s3_max_date]
      properties:
        db_min_date:
          type: string
          format: date-time
          nullable: true
        db_max_date:
          type: string
          format: date-time
          nullable: true
        s3_min_date:
          type: string
          format: date-time
          nullable: true
        s3_max_date:
          type: string
          format: date-time
          nullable: true
    MonitorSocialSettings:
      type: object
      required:
        [
          id,
          key,
          focus_account,
          target_quarterly_sov_pp,
          target_shs,
          risk_threshold,
          sentiment_drop_threshold,
          er_drop_threshold,
          alert_cooldown_minutes,
          metadata,
          updated_by_user_id,
          created_at,
          updated_at
        ]
      properties:
        id:
          type: string
          format: uuid
        key:
          type: string
        focus_account:
          type: string
          nullable: true
        target_quarterly_sov_pp:
          type: number
        target_shs:
          type: number
        risk_threshold:
          type: number
        sentiment_drop_threshold:
          type: number
        er_drop_threshold:
          type: number
        alert_cooldown_minutes:
          type: integer
        metadata:
          type: object
          additionalProperties: true
        updated_by_user_id:
          type: string
          format: uuid
          nullable: true
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
    MonitorSocialOverviewResponse:
      type: object
      required:
        [
          generated_at,
          last_etl_at,
          official,
          preset,
          window_days,
          window_start,
          window_end,
          comparison,
          trend_granularity_applied,
          kpis,
          previous_period,
          delta_vs_previous,
          target_progress,
          trend_series,
          trend_daily,
          by_channel,
          by_account,
          diagnostics,
          coverage,
          reconciliation_status,
          settings
        ]
      properties:
        generated_at:
          type: string
          format: date-time
        last_etl_at:
          type: string
          format: date-time
          nullable: true
        official:
          type: boolean
          const: false
        preset:
          $ref: '#/components/schemas/SocialDatePreset'
        window_days:
          type: integer
        window_start:
          type: string
          format: date-time
        window_end:
          type: string
          format: date-time
        comparison:
          $ref: '#/components/schemas/MonitorSocialComparison'
        trend_granularity_applied:
          type: string
          enum: [day, week, month]
        kpis:
          $ref: '#/components/schemas/MonitorSocialKpis'
        previous_period:
          $ref: '#/components/schemas/MonitorSocialPreviousPeriod'
        delta_vs_previous:
          $ref: '#/components/schemas/MonitorSocialDelta'
        target_progress:
          $ref: '#/components/schemas/MonitorSocialTargetProgress'
        trend_series:
          type: array
          items:
            $ref: '#/components/schemas/MonitorSocialTrendSeriesItem'
        trend_daily:
          type: array
          items:
            $ref: '#/components/schemas/MonitorSocialTrendItem'
        by_channel:
          type: array
          items:
            $ref: '#/components/schemas/MonitorSocialByChannelItem'
        by_account:
          type: array
          items:
            $ref: '#/components/schemas/MonitorSocialByAccountItem'
        diagnostics:
          $ref: '#/components/schemas/MonitorSocialDiagnostics'
        coverage:
          $ref: '#/components/schemas/MonitorSocialCoverage'
        reconciliation_status:
          $ref: '#/components/schemas/SocialReconciliationStatus'
        settings:
          $ref: '#/components/schemas/MonitorSocialSettings'
    MonitorSocialFacetItem:
      type: object
      required: [value, count]
      properties:
        value:
          type: string
        count:
          type: integer
    MonitorSocialFacets:
      type: object
      required: [account, post_type, campaign, strategy, hashtag, topic, sentiment]
      properties:
        account:
          type: array
          items:
            $ref: '#/components/schemas/MonitorSocialFacetItem'
        post_type:
          type: array
          items:
            $ref: '#/components/schemas/MonitorSocialFacetItem'
        campaign:
          type: array
          items:
            $ref: '#/components/schemas/MonitorSocialFacetItem'
        strategy:
          type: array
          items:
            $ref: '#/components/schemas/MonitorSocialFacetItem'
        hashtag:
          type: array
          items:
            $ref: '#/components/schemas/MonitorSocialFacetItem'
        topic:
          type: array
          items:
            $ref: '#/components/schemas/MonitorSocialFacetItem'
        sentiment:
          type: array
          items:
            $ref: '#/components/schemas/MonitorSocialFacetItem'
    MonitorSocialFacetsTotals:
      type: object
      required: [posts, accounts]
      properties:
        posts:
          type: integer
        accounts:
          type: integer
    MonitorSocialFacetsResponse:
      type: object
      required: [generated_at, preset, window_start, window_end, totals, facets]
      properties:
        generated_at:
          type: string
          format: date-time
        preset:
          $ref: '#/components/schemas/SocialDatePreset'
        window_start:
          type: string
          format: date-time
        window_end:
          type: string
          format: date-time
        totals:
          $ref: '#/components/schemas/MonitorSocialFacetsTotals'
        facets:
          $ref: '#/components/schemas/MonitorSocialFacets'
    MonitorSocialAccountItem:
      type: object
      required:
        [
          account_name,
          channel_mix,
          posts,
          exposure_total,
          engagement_total,
          er_ponderado,
          sentimiento_neto,
          riesgo_activo,
          sov_interno,
          delta_exposure,
          delta_engagement,
          delta_er,
          meets_threshold
        ]
      properties:
        account_name:
          type: string
        channel_mix:
          type: array
          items:
            $ref: '#/components/schemas/SocialChannel'
        posts:
          type: integer
        exposure_total:
          type: number
        engagement_total:
          type: number
        impressions_total:
          type: number
        reach_total:
          type: number
        clicks_total:
          type: number
        likes_total:
          type: number
        comments_total:
          type: number
        shares_total:
          type: number
        views_total:
          type: number
        er_ponderado:
          type: number
        ctr:
          type: number
        er_impressions:
          type: number
        er_reach:
          type: number
        view_rate:
          type: number
        likes_share:
          type: number
        comments_share:
          type: number
        shares_share:
          type: number
        sentimiento_neto:
          type: number
        riesgo_activo:
          type: number
        sov_interno:
          type: number
        delta_exposure:
          type: number
        delta_engagement:
          type: number
        delta_er:
          type: number
        meets_threshold:
          type: boolean
    MonitorSocialAccountsResponse:
      type: object
      required: [generated_at, last_etl_at, preset, window_start, window_end, min_posts, min_exposure, sort_applied, items, page_info]
      properties:
        generated_at:
          type: string
          format: date-time
        last_etl_at:
          type: string
          format: date-time
          nullable: true
        preset:
          $ref: '#/components/schemas/SocialDatePreset'
        window_start:
          type: string
          format: date-time
        window_end:
          type: string
          format: date-time
        min_posts:
          type: integer
        min_exposure:
          type: integer
        sort_applied:
          $ref: '#/components/schemas/SocialAccountsSort'
        items:
          type: array
          items:
            $ref: '#/components/schemas/MonitorSocialAccountItem'
        page_info:
          $ref: '#/components/schemas/PageInfo'
    MonitorSocialRiskTrendItem:
      type: object
      required: [date, clasificados, positivos, negativos, neutrales, sentimiento_neto, riesgo_activo]
      properties:
        date:
          type: string
        clasificados:
          type: integer
        positivos:
          type: integer
        negativos:
          type: integer
        neutrales:
          type: integer
        sentimiento_neto:
          type: number
        riesgo_activo:
          type: number
    MonitorSocialRiskChannelItem:
      type: object
      required: [channel, clasificados, negativos, riesgo_activo]
      properties:
        channel:
          $ref: '#/components/schemas/SocialChannel'
        clasificados:
          type: integer
        negativos:
          type: integer
        riesgo_activo:
          type: number
    MonitorSocialRiskAccountItem:
      type: object
      required: [account_name, clasificados, negativos, riesgo_activo]
      properties:
        account_name:
          type: string
        clasificados:
          type: integer
        negativos:
          type: integer
        riesgo_activo:
          type: number
    MonitorSocialAlertItem:
      type: object
      required: [id, severity, status, risk_score, classified_items, updated_at, cooldown_until]
      properties:
        id:
          type: string
          format: uuid
        severity:
          $ref: '#/components/schemas/MonitorSeverity'
        status:
          $ref: '#/components/schemas/IncidentStatus'
        risk_score:
          type: number
        classified_items:
          type: integer
        updated_at:
          type: string
          format: date-time
        cooldown_until:
          type: string
          format: date-time
          nullable: true
    MonitorSocialRiskThresholds:
      type: object
      required: [risk_threshold, sentiment_drop_threshold, er_drop_threshold]
      properties:
        risk_threshold:
          type: number
        sentiment_drop_threshold:
          type: number
        er_drop_threshold:
          type: number
    MonitorSocialRiskResponse:
      type: object
      required:
        [generated_at, last_etl_at, preset, window_start, window_end, stale_data, stale_after_minutes, thresholds, sentiment_trend, by_channel, by_account, alerts]
      properties:
        generated_at:
          type: string
          format: date-time
        last_etl_at:
          type: string
          format: date-time
          nullable: true
        preset:
          $ref: '#/components/schemas/SocialDatePreset'
        window_start:
          type: string
          format: date-time
        window_end:
          type: string
          format: date-time
        stale_data:
          type: boolean
        stale_after_minutes:
          type: integer
        thresholds:
          $ref: '#/components/schemas/MonitorSocialRiskThresholds'
        sentiment_trend:
          type: array
          items:
            $ref: '#/components/schemas/MonitorSocialRiskTrendItem'
        by_channel:
          type: array
          items:
            $ref: '#/components/schemas/MonitorSocialRiskChannelItem'
        by_account:
          type: array
          items:
            $ref: '#/components/schemas/MonitorSocialRiskAccountItem'
        alerts:
          type: array
          items:
            $ref: '#/components/schemas/MonitorSocialAlertItem'
    MonitorSocialPostItem:
      type: object
      required:
        [
          id,
          content_item_id,
          origin,
          medium,
          tags,
          channel,
          account_name,
          external_post_id,
          post_url,
          post_type,
          published_at,
          title,
          text,
          sentiment,
          sentiment_raw,
          sentiment_confidence,
          exposure,
          engagement_total,
          impressions,
          reach,
          clicks,
          likes,
          comments,
          awario_comments_count,
          shares,
          views,
          source_score,
          campaign,
          strategies,
          hashtags,
          topics,
          topics_version,
          topics_needs_review,
          created_at,
          updated_at
        ]
      properties:
        id:
          type: string
          format: uuid
        content_item_id:
          type: string
          format: uuid
        origin:
          $ref: '#/components/schemas/OriginType'
        medium:
          type: string
          nullable: true
        tags:
          $ref: '#/components/schemas/ContentTags'
        channel:
          $ref: '#/components/schemas/SocialChannel'
        account_name:
          type: string
        external_post_id:
          type: string
        post_url:
          type: string
        post_type:
          type: string
          nullable: true
        published_at:
          type: string
          format: date-time
          nullable: true
        title:
          type: string
        text:
          type: string
          nullable: true
        sentiment:
          $ref: '#/components/schemas/SocialSentiment'
        sentiment_raw:
          type: string
          nullable: true
        sentiment_confidence:
          type: number
          nullable: true
        exposure:
          type: number
        engagement_total:
          type: number
        impressions:
          type: number
        reach:
          type: number
        clicks:
          type: number
        likes:
          type: number
        comments:
          type: number
        awario_comments_count:
          type: integer
        shares:
          type: number
        views:
          type: number
        source_score:
          type: number
        campaign:
          type: string
          nullable: true
        strategies:
          type: array
          items:
            type: string
        hashtags:
          type: array
          items:
            type: string
        topics:
          type: array
          items:
            $ref: '#/components/schemas/MonitorSocialTopicItem'
        topics_version:
          type: string
          nullable: true
        topics_needs_review:
          type: boolean
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
    MonitorSocialTopicItem:
      type: object
      required: [key, label, confidence, rank]
      properties:
        key:
          type: string
        label:
          type: string
        confidence:
          type: number
        rank:
          type: integer
    MonitorSocialPostsResponse:
      type: object
      required: [items, page_info]
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/MonitorSocialPostItem'
        page_info:
          $ref: '#/components/schemas/PageInfo'
    MonitorSocialCommentItem:
      type: object
      required:
        [
          id,
          social_post_metric_id,
          origin,
          medium,
          tags,
          awario_mention_id,
          awario_alert_id,
          channel,
          parent_external_post_id,
          sentiment,
          sentiment_source,
          is_spam,
          related_to_post_text,
          needs_review,
          confidence,
          raw_payload,
          created_at,
          updated_at
        ]
      properties:
        id:
          type: string
          format: uuid
        social_post_metric_id:
          type: string
          format: uuid
        origin:
          $ref: '#/components/schemas/OriginType'
        medium:
          type: string
          nullable: true
        tags:
          $ref: '#/components/schemas/ContentTags'
        awario_mention_id:
          type: string
        awario_alert_id:
          type: string
        channel:
          $ref: '#/components/schemas/SocialChannel'
        parent_external_post_id:
          type: string
        external_comment_id:
          type: string
          nullable: true
        external_reply_comment_id:
          type: string
          nullable: true
        comment_url:
          type: string
          nullable: true
        author_name:
          type: string
          nullable: true
        author_profile_url:
          type: string
          nullable: true
        published_at:
          type: string
          format: date-time
          nullable: true
        text:
          type: string
          nullable: true
        sentiment:
          $ref: '#/components/schemas/SocialSentiment'
        sentiment_source:
          type: string
          enum: [awario, model, manual]
        is_spam:
          type: boolean
        related_to_post_text:
          type: boolean
        needs_review:
          type: boolean
        confidence:
          type: number
          nullable: true
        raw_payload:
          type: object
          additionalProperties: true
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
    MonitorSocialPostCommentsResponse:
      type: object
      required: [items, page_info]
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/MonitorSocialCommentItem'
        page_info:
          $ref: '#/components/schemas/PageInfo'
    PatchMonitorSocialCommentRequest:
      type: object
      properties:
        is_spam:
          type: boolean
        related_to_post_text:
          type: boolean
        sentiment:
          $ref: '#/components/schemas/SocialSentiment'
        reason:
          type: string
          maxLength: 600
    MonitorSocialHeatmapPoint:
      type: object
      required: [month, weekday, value, posts]
      properties:
        month:
          type: integer
          minimum: 1
          maximum: 12
        weekday:
          type: integer
          minimum: 1
          maximum: 7
        value:
          type: number
        posts:
          type: integer
    MonitorSocialHeatmapResponse:
      type: object
      required: [generated_at, metric, items]
      properties:
        generated_at:
          type: string
          format: date-time
        metric:
          $ref: '#/components/schemas/SocialHeatmapMetric'
        items:
          type: array
          items:
            $ref: '#/components/schemas/MonitorSocialHeatmapPoint'
    MonitorSocialScatterItem:
      type: object
      required: [label, exposure_total, engagement_total, er_global, posts]
      properties:
        label:
          type: string
        exposure_total:
          type: number
        engagement_total:
          type: number
        impressions_total:
          type: number
        reach_total:
          type: number
        clicks_total:
          type: number
        likes_total:
          type: number
        comments_total:
          type: number
        shares_total:
          type: number
        views_total:
          type: number
        er_global:
          type: number
        ctr:
          type: number
        er_impressions:
          type: number
        er_reach:
          type: number
        view_rate:
          type: number
        likes_share:
          type: number
        comments_share:
          type: number
        shares_share:
          type: number
        posts:
          type: integer
    MonitorSocialScatterResponse:
      type: object
      required: [generated_at, dimension, items]
      properties:
        generated_at:
          type: string
          format: date-time
        dimension:
          $ref: '#/components/schemas/SocialScatterDimension'
        items:
          type: array
          items:
            $ref: '#/components/schemas/MonitorSocialScatterItem'
    MonitorSocialTrendByDimensionPoint:
      type: object
      required: [bucket_start, bucket_end, bucket_label, value, posts]
      properties:
        bucket_start:
          type: string
          format: date-time
        bucket_end:
          type: string
          format: date-time
        bucket_label:
          type: string
        value:
          type: number
        posts:
          type: integer
    MonitorSocialTrendByDimensionSeriesItem:
      type: object
      required: [label, metric_total, posts_total, points]
      properties:
        label:
          type: string
        metric_total:
          type: number
        posts_total:
          type: integer
        points:
          type: array
          items:
            $ref: '#/components/schemas/MonitorSocialTrendByDimensionPoint'
    MonitorSocialTrendByDimensionResponse:
      type: object
      required:
        [
          generated_at,
          window_start,
          window_end,
          trend_granularity_applied,
          dimension,
          metric,
          series_limit_applied,
          series
        ]
      properties:
        generated_at:
          type: string
          format: date-time
        window_start:
          type: string
          format: date-time
        window_end:
          type: string
          format: date-time
        trend_granularity_applied:
          type: string
          enum: [day, week, month]
        dimension:
          $ref: '#/components/schemas/SocialScatterDimension'
        metric:
          $ref: '#/components/schemas/SocialTrendByDimensionMetric'
        series_limit_applied:
          type: integer
        series:
          type: array
          items:
            $ref: '#/components/schemas/MonitorSocialTrendByDimensionSeriesItem'
    MonitorSocialTopicBreakdownSegment:
      type: object
      required: [key, label, metric_value, posts]
      properties:
        key:
          type: string
        label:
          type: string
        metric_value:
          type: number
        posts:
          type: integer
    MonitorSocialTopicBreakdownItem:
      type: object
      required: [topic_key, topic_label, metric_total, posts_total, segments]
      properties:
        topic_key:
          type: string
        topic_label:
          type: string
        metric_total:
          type: number
        posts_total:
          type: integer
        segments:
          type: array
          items:
            $ref: '#/components/schemas/MonitorSocialTopicBreakdownSegment'
    MonitorSocialTopicBreakdownResponse:
      type: object
      required: [generated_at, dimension, metric, topic_limit_applied, segment_limit_applied, segments_order, items]
      properties:
        generated_at:
          type: string
          format: date-time
        dimension:
          $ref: '#/components/schemas/SocialTopicBreakdownDimension'
        metric:
          $ref: '#/components/schemas/SocialTrendByDimensionMetric'
        topic_limit_applied:
          type: integer
        segment_limit_applied:
          type: integer
        segments_order:
          type: array
          items:
            type: object
            required: [key, label]
            properties:
              key:
                type: string
              label:
                type: string
        items:
          type: array
          items:
            $ref: '#/components/schemas/MonitorSocialTopicBreakdownItem'
    MonitorSocialErBreakdownItem:
      type: object
      required: [label, posts, exposure_total, engagement_total, er_global]
      properties:
        label:
          type: string
        posts:
          type: integer
        exposure_total:
          type: number
        engagement_total:
          type: number
        impressions_total:
          type: number
        reach_total:
          type: number
        clicks_total:
          type: number
        likes_total:
          type: number
        comments_total:
          type: number
        shares_total:
          type: number
        views_total:
          type: number
        er_global:
          type: number
        ctr:
          type: number
        er_impressions:
          type: number
        er_reach:
          type: number
        view_rate:
          type: number
        likes_share:
          type: number
        comments_share:
          type: number
        shares_share:
          type: number
    MonitorSocialErBreakdownResponse:
      type: object
      required: [generated_at, dimension, items]
      properties:
        generated_at:
          type: string
          format: date-time
        dimension:
          $ref: '#/components/schemas/SocialErBreakdownDimension'
        items:
          type: array
          items:
            $ref: '#/components/schemas/MonitorSocialErBreakdownItem'
    MonitorSocialErTargetsResponse:
      type: object
      required: [generated_at, last_etl_at, year, items]
      properties:
        generated_at:
          type: string
          format: date-time
        last_etl_at:
          type: string
          format: date-time
          nullable: true
        year:
          type: integer
        items:
          type: array
          items:
            $ref: '#/components/schemas/MonitorSocialErTargetProgressItem'
    PatchMonitorSocialErTargetItem:
      type: object
      required: [channel, source]
      properties:
        channel:
          $ref: '#/components/schemas/SocialChannel'
        source:
          type: string
          enum: [auto, manual]
        target_2026_er:
          type: number
        override_reason:
          type: string
          maxLength: 220
    PatchMonitorSocialErTargetsRequest:
      type: object
      required: [targets]
      properties:
        year:
          type: integer
          minimum: 1
          maximum: 2100
        targets:
          type: array
          minItems: 1
          items:
            $ref: '#/components/schemas/PatchMonitorSocialErTargetItem'
    MonitorSocialTopicsBackfillRequest:
      type: object
      properties:
        from:
          type: string
          format: date-time
          default: '2024-01-01T00:00:00Z'
        to:
          type: string
          format: date-time
          nullable: true
        limit:
          type: integer
          minimum: 1
          maximum: 5000
          default: 500
        dry_run:
          type: boolean
          default: false
    MonitorSocialTopicsBackfillResponse:
      type: object
      required: [status, run_id, selected_count, enqueued_count]
      properties:
        status:
          type: string
          enum: [accepted]
        run_id:
          type: string
        selected_count:
          type: integer
        enqueued_count:
          type: integer
    MonitorSocialTopicsLastRun:
      type: object
      required: [createdAt]
      properties:
        runId:
          type: string
          nullable: true
        status:
          type: string
          enum: [completed, failed]
          nullable: true
        triggerType:
          type: string
          enum: [manual, scheduled]
          nullable: true
        requestedAt:
          type: string
          format: date-time
          nullable: true
        from:
          type: string
          format: date-time
          nullable: true
        to:
          type: string
          format: date-time
          nullable: true
        limit:
          type: integer
          nullable: true
        dryRun:
          type: boolean
          nullable: true
        selectedCount:
          type: integer
          nullable: true
        enqueuedCount:
          type: integer
          nullable: true
        errorMessage:
          type: string
          nullable: true
        createdAt:
          type: string
          format: date-time
    MonitorSocialTopicsStatusResponse:
      type: object
      required: [generated_at, window_start, window_end, taxonomy_version, prompt_version, total_posts, classified, pending, in_review, last_run]
      properties:
        generated_at:
          type: string
          format: date-time
        window_start:
          type: string
          format: date-time
        window_end:
          type: string
          format: date-time
          nullable: true
        taxonomy_version:
          type: string
        prompt_version:
          type: string
        total_posts:
          type: integer
        classified:
          type: integer
        pending:
          type: integer
        in_review:
          type: integer
        last_run:
          allOf:
            - $ref: '#/components/schemas/MonitorSocialTopicsLastRun'
          nullable: true
    MonitorSocialHashtagBackfillResponse:
      type: object
      required: [status, updated_rows]
      properties:
        status:
          type: string
          enum: [accepted]
        updated_rows:
          type: integer
    MonitorSocialReconciliationItem:
      type: object
      required: [channel, s3Rows, dbRows, deltaRows, s3MinDate, s3MaxDate, dbMinDate, dbMaxDate, status, runId, createdAt]
      properties:
        channel:
          $ref: '#/components/schemas/SocialChannel'
        s3Rows:
          type: number
        dbRows:
          type: number
        deltaRows:
          type: number
        s3MinDate:
          type: string
          format: date-time
          nullable: true
        s3MaxDate:
          type: string
          format: date-time
          nullable: true
        dbMinDate:
          type: string
          format: date-time
          nullable: true
        dbMaxDate:
          type: string
          format: date-time
          nullable: true
        status:
          $ref: '#/components/schemas/SocialReconciliationStatus'
        runId:
          type: string
          format: uuid
        createdAt:
          type: string
          format: date-time
    MonitorSocialRunItem:
      type: object
      required:
        [
          id,
          trigger_type,
          status,
          request_id,
          queued_at,
          started_at,
          finished_at,
          current_phase,
          phase_status,
          counters,
          metrics,
          error_message,
          created_at
        ]
      properties:
        id:
          type: string
          format: uuid
        trigger_type:
          $ref: '#/components/schemas/TriggerType'
        status:
          $ref: '#/components/schemas/RunStatus'
        request_id:
          type: string
          nullable: true
        queued_at:
          type: string
          format: date-time
        started_at:
          type: string
          format: date-time
          nullable: true
        finished_at:
          type: string
          format: date-time
          nullable: true
        current_phase:
          $ref: '#/components/schemas/SocialSyncPhase'
          nullable: true
        phase_status:
          type: object
          additionalProperties: true
          nullable: true
        counters:
          $ref: '#/components/schemas/SocialRunCounters'
        metrics:
          type: object
          additionalProperties: true
        error_message:
          type: string
          nullable: true
        created_at:
          type: string
          format: date-time
    MonitorSocialRunsResponse:
      type: object
      required: [items, page_info]
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/MonitorSocialRunItem'
        page_info:
          $ref: '#/components/schemas/PageInfo'
    MonitorSocialEtlQualityResponse:
      type: object
      required: [generated_at, last_etl_at, coverage, reconciliation_status, reconciliation_by_channel, runs]
      properties:
        generated_at:
          type: string
          format: date-time
        last_etl_at:
          type: string
          format: date-time
          nullable: true
        coverage:
          type: object
          required: [db_min_date, db_max_date, s3_min_date, s3_max_date]
          properties:
            db_min_date:
              type: string
              format: date-time
              nullable: true
            db_max_date:
              type: string
              format: date-time
              nullable: true
            s3_min_date:
              type: string
              format: date-time
              nullable: true
            s3_max_date:
              type: string
              format: date-time
              nullable: true
        reconciliation_status:
          $ref: '#/components/schemas/SocialReconciliationStatus'
        reconciliation_by_channel:
          type: array
          items:
            $ref: '#/components/schemas/MonitorSocialReconciliationItem'
        runs:
          type: array
          items:
            type: object
            required:
              [id, triggerType, status, queuedAt, startedAt, finishedAt, currentPhase, counters, malformedRows, errorMessage]
            properties:
              id:
                type: string
                format: uuid
              triggerType:
                $ref: '#/components/schemas/TriggerType'
              status:
                $ref: '#/components/schemas/RunStatus'
              queuedAt:
                type: string
                format: date-time
              startedAt:
                type: string
                format: date-time
                nullable: true
              finishedAt:
                type: string
                format: date-time
                nullable: true
              currentPhase:
                $ref: '#/components/schemas/SocialSyncPhase'
                nullable: true
              counters:
                $ref: '#/components/schemas/SocialRunCounters'
              malformedRows:
                type: integer
              errorMessage:
                type: string
                nullable: true
    CreateMonitorSocialRunRequest:
      type: object
      properties:
        force:
          type: boolean
          default: false
        bucket:
          type: string
        prefix:
          type: string
    MonitorSocialRunAccepted:
      type: object
      required: [status, run_id, queued_at]
      properties:
        status:
          type: string
          const: accepted
        run_id:
          type: string
          format: uuid
        queued_at:
          type: string
          format: date-time
    PatchMonitorSocialSettingsRequest:
      type: object
      properties:
        focus_account:
          type: string
          nullable: true
        target_quarterly_sov_pp:
          type: number
        target_shs:
          type: number
        risk_threshold:
          type: number
        sentiment_drop_threshold:
          type: number
        er_drop_threshold:
          type: number
        alert_cooldown_minutes:
          type: integer
        metadata:
          type: object
          additionalProperties: true
    AnalyzeOverviewDelta:
      type: object
      required: [items, classified_items, sentimiento_neto, bhs, riesgo_activo, sov_claro, sov_competencia]
      properties:
        items:
          type: integer
        classified_items:
          type: integer
        sentimiento_neto:
          type: number
        bhs:
          type: number
        riesgo_activo:
          type: number
        sov_claro:
          type: number
        sov_competencia:
          type: number
    AnalyzeOverviewResponse:
      type: object
      required: [generated_at, window_days, source_type, formula_version, totals, previous_totals, delta, by_scope, diagnostics]
      properties:
        generated_at:
          type: string
          format: date-time
        window_days:
          type: integer
          const: 7
        source_type:
          type: string
          const: news
        formula_version:
          type: string
          const: analysis-v1
        totals:
          $ref: '#/components/schemas/MonitorTotalsKpi'
        previous_totals:
          $ref: '#/components/schemas/MonitorTotalsKpi'
        delta:
          $ref: '#/components/schemas/AnalyzeOverviewDelta'
        by_scope:
          type: object
          required: [claro, competencia]
          properties:
            claro:
              $ref: '#/components/schemas/MonitorScopeKpi'
            competencia:
              $ref: '#/components/schemas/MonitorScopeKpi'
        diagnostics:
          $ref: '#/components/schemas/MonitorDiagnostics'
    AnalyzeCategoryCount:
      type: object
      required: [value, count]
      properties:
        value:
          type: string
        count:
          type: integer
    AnalyzeChannelItem:
      type: object
      required:
        [provider, items, classified_items, positivos, negativos, neutrales, sentimiento_neto, riesgo_activo, quality_score, bhs, severidad, top_categories, insufficient_data]
      properties:
        provider:
          type: string
        items:
          type: integer
        classified_items:
          type: integer
        positivos:
          type: integer
        negativos:
          type: integer
        neutrales:
          type: integer
        sentimiento_neto:
          type: number
        riesgo_activo:
          type: number
        quality_score:
          type: number
        bhs:
          type: number
        severidad:
          $ref: '#/components/schemas/MonitorSeverity'
        top_categories:
          type: array
          items:
            $ref: '#/components/schemas/AnalyzeCategoryCount'
        insufficient_data:
          type: boolean
    AnalyzeChannelResponse:
      type: object
      required: [generated_at, window_days, source_type, formula_version, totals, items]
      properties:
        generated_at:
          type: string
          format: date-time
        window_days:
          type: integer
          const: 7
        source_type:
          type: string
          const: news
        formula_version:
          type: string
          const: analysis-v1
        totals:
          type: object
          required: [providers, items, classified_items]
          properties:
            providers:
              type: integer
            items:
              type: integer
            classified_items:
              type: integer
        items:
          type: array
          items:
            $ref: '#/components/schemas/AnalyzeChannelItem'
    AnalyzeScopeBenchmark:
      type: object
      required:
        [items, classified_items, positivos, negativos, neutrales, sentimiento_neto, riesgo_activo, quality_score, bhs, severidad, sov, insufficient_data]
      properties:
        items:
          type: integer
        classified_items:
          type: integer
        positivos:
          type: integer
        negativos:
          type: integer
        neutrales:
          type: integer
        sentimiento_neto:
          type: number
        riesgo_activo:
          type: number
        quality_score:
          type: number
        bhs:
          type: number
        severidad:
          $ref: '#/components/schemas/MonitorSeverity'
        sov:
          type: number
        insufficient_data:
          type: boolean
    AnalyzeCompetitorItem:
      allOf:
        - $ref: '#/components/schemas/AnalyzeScopeBenchmark'
        - type: object
          required: [term_id, term_name]
          properties:
            term_id:
              type: string
              format: uuid
            term_name:
              type: string
    AnalyzeCompetitorsResponse:
      type: object
      required: [generated_at, window_days, source_type, formula_version, baseline_claro, competitors, totals]
      properties:
        generated_at:
          type: string
          format: date-time
        window_days:
          type: integer
          const: 7
        source_type:
          type: string
          const: news
        formula_version:
          type: string
          const: analysis-v1
        baseline_claro:
          $ref: '#/components/schemas/AnalyzeScopeBenchmark'
        competitors:
          type: array
          items:
            $ref: '#/components/schemas/AnalyzeCompetitorItem'
        totals:
          type: object
          required: [competitor_terms, items, classified_items]
          properties:
            competitor_terms:
              type: integer
            items:
              type: integer
            classified_items:
              type: integer
    IncidentOwner:
      type: object
      required: [user_id]
      properties:
        user_id:
          type: string
          format: uuid
        name:
          type: string
          nullable: true
        email:
          type: string
          nullable: true
        role:
          type: string
          nullable: true
    Incident:
      type: object
      required:
        [
          id,
          scope,
          severity,
          status,
          risk_score,
          classified_items,
          sla_due_at,
          sla_remaining_minutes,
          cooldown_until,
          signal_version,
          payload,
          created_at,
          updated_at
        ]
      properties:
        id:
          type: string
          format: uuid
        scope:
          $ref: '#/components/schemas/TermScope'
        severity:
          $ref: '#/components/schemas/MonitorSeverity'
        status:
          $ref: '#/components/schemas/IncidentStatus'
        risk_score:
          type: number
        classified_items:
          type: integer
        owner_user_id:
          type: string
          format: uuid
          nullable: true
        owner:
          allOf:
            - $ref: '#/components/schemas/IncidentOwner'
          nullable: true
        sla_due_at:
          type: string
          format: date-time
        sla_remaining_minutes:
          type: integer
        cooldown_until:
          type: string
          format: date-time
        signal_version:
          type: string
        payload:
          type: object
          additionalProperties: true
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
        resolved_at:
          type: string
          format: date-time
          nullable: true
    IncidentListResponse:
      type: object
      required: [items, page_info]
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/Incident'
        page_info:
          $ref: '#/components/schemas/PageInfo'
    PatchIncidentRequest:
      type: object
      properties:
        status:
          $ref: '#/components/schemas/IncidentStatus'
        owner_user_id:
          type: string
          format: uuid
          nullable: true
        note:
          type: string
          minLength: 1
          maxLength: 2000
      additionalProperties: false
    IncidentNote:
      type: object
      required: [id, incident_id, author_user_id, author, note, created_at]
      properties:
        id:
          type: string
          format: uuid
        incident_id:
          type: string
          format: uuid
        author_user_id:
          type: string
          format: uuid
        author:
          $ref: '#/components/schemas/IncidentOwner'
        note:
          type: string
        created_at:
          type: string
          format: date-time
    PatchIncidentResponse:
      type: object
      required: [incident]
      properties:
        incident:
          $ref: '#/components/schemas/Incident'
        note:
          allOf:
            - $ref: '#/components/schemas/IncidentNote'
          nullable: true
    IncidentNotesResponse:
      type: object
      required: [items]
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/IncidentNote'
    CreateIncidentNoteRequest:
      type: object
      required: [note]
      properties:
        note:
          type: string
          minLength: 1
          maxLength: 2000
      additionalProperties: false
    IncidentEvaluationAccepted:
      type: object
      required: [status, trigger_type]
      properties:
        status:
          type: string
          const: queued
        trigger_type:
          type: string
          enum: [manual]
        message_id:
          type: string
          nullable: true
    MetaResponse:
      type: object
      properties:
        providers:
          type: array
          items:
            $ref: '#/components/schemas/MetaCountItem'
        categories:
          type: array
          items:
            $ref: '#/components/schemas/MetaCountItem'
        sentimientos:
          type: array
          items:
            $ref: '#/components/schemas/MetaCountItem'
        states:
          type: array
          items:
            $ref: '#/components/schemas/MetaCountItem'
    MetaCountItem:
      type: object
      required: [value, count]
      properties:
        value:
          type: string
        count:
          type: integer
    ConnectorHealth:
      type: string
      enum: [unknown, healthy, degraded, offline]
    Connector:
      type: object
      required: [id, provider, enabled, frequency_minutes, health_status, created_at, updated_at]
      properties:
        id:
          type: string
          format: uuid
        provider:
          type: string
        enabled:
          type: boolean
        frequency_minutes:
          type: integer
        health_status:
          $ref: '#/components/schemas/ConnectorHealth'
        last_sync_at:
          type: string
          format: date-time
          nullable: true
        last_error:
          type: string
          nullable: true
        latency_p95_ms:
          type: integer
          nullable: true
        metadata:
          type: object
          additionalProperties: true
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
    PatchConnectorRequest:
      type: object
      properties:
        enabled:
          type: boolean
        frequency_minutes:
          type: integer
          minimum: 5
          maximum: 1440
    ConnectorSyncRun:
      type: object
      required: [id, connector_id, status, created_at]
      properties:
        id:
          type: string
          format: uuid
        connector_id:
          type: string
          format: uuid
        status:
          type: string
          enum: [queued, running, completed, failed]
        started_at:
          type: string
          format: date-time
          nullable: true
        finished_at:
          type: string
          format: date-time
          nullable: true
        metrics:
          type: object
          additionalProperties: true
        error:
          type: string
          nullable: true
        triggered_by_user_id:
          type: string
          format: uuid
          nullable: true
        created_at:
          type: string
          format: date-time
    ConnectorListResponse:
      type: object
      required: [items]
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/Connector'
    ConnectorRunListResponse:
      type: object
      required: [connector_id, items]
      properties:
        connector_id:
          type: string
          format: uuid
        items:
          type: array
          items:
            $ref: '#/components/schemas/ConnectorSyncRun'
    AwarioStatus:
      type: string
      enum: [active, paused, archived]
    AwarioValidationStatus:
      type: string
      enum: [valid, invalid, unknown]
    AwarioSyncState:
      type: string
      enum: [pending_backfill, backfilling, active, error, paused, archived]
    AwarioQueryProfile:
      type: object
      required: [id, name, query_text, sources, countries, status, metadata, created_at, updated_at]
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        objective:
          type: string
          nullable: true
        query_text:
          type: string
        sources:
          type: array
          items:
            type: string
        language:
          type: string
          nullable: true
        countries:
          type: array
          items:
            type: string
        status:
          $ref: '#/components/schemas/AwarioStatus'
        metadata:
          type: object
          additionalProperties: true
        created_by_user_id:
          type: string
          format: uuid
          nullable: true
        updated_by_user_id:
          type: string
          format: uuid
          nullable: true
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
    AwarioQueryProfileListResponse:
      type: object
      required: [items]
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/AwarioQueryProfile'
    CreateAwarioQueryProfileRequest:
      type: object
      required: [name, query_text]
      properties:
        name:
          type: string
          minLength: 2
        objective:
          type: string
          maxLength: 1000
          nullable: true
        query_text:
          type: string
          minLength: 2
        sources:
          type: array
          items:
            type: string
        language:
          type: string
          nullable: true
        countries:
          type: array
          items:
            type: string
        status:
          $ref: '#/components/schemas/AwarioStatus'
        metadata:
          type: object
          additionalProperties: true
    UpdateAwarioQueryProfileRequest:
      type: object
      properties:
        name:
          type: string
          minLength: 2
        objective:
          type: string
          maxLength: 1000
          nullable: true
        query_text:
          type: string
          minLength: 2
        sources:
          type: array
          items:
            type: string
        language:
          type: string
          nullable: true
        countries:
          type: array
          items:
            type: string
        status:
          $ref: '#/components/schemas/AwarioStatus'
        metadata:
          type: object
          additionalProperties: true
    AwarioAlertBinding:
      type: object
      required:
        [id, profile_id, awario_alert_id, status, sync_state, validation_status, metadata, created_at, updated_at]
      properties:
        id:
          type: string
          format: uuid
        profile_id:
          type: string
          format: uuid
        profile_name:
          type: string
          nullable: true
        connector_id:
          type: string
          format: uuid
          nullable: true
        awario_alert_id:
          type: string
        status:
          $ref: '#/components/schemas/AwarioStatus'
        sync_state:
          $ref: '#/components/schemas/AwarioSyncState'
        validation_status:
          $ref: '#/components/schemas/AwarioValidationStatus'
        last_validated_at:
          type: string
          format: date-time
          nullable: true
        last_validation_error:
          type: string
          nullable: true
        last_sync_at:
          type: string
          format: date-time
          nullable: true
        last_sync_error:
          type: string
          nullable: true
        backfill_started_at:
          type: string
          format: date-time
          nullable: true
        backfill_completed_at:
          type: string
          format: date-time
          nullable: true
        backfill_cursor:
          type: string
          nullable: true
        metadata:
          type: object
          additionalProperties: true
        created_by_user_id:
          type: string
          format: uuid
          nullable: true
        updated_by_user_id:
          type: string
          format: uuid
          nullable: true
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
    AwarioAlertBindingListResponse:
      type: object
      required: [items]
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/AwarioAlertBinding'
    CreateAwarioAlertBindingRequest:
      type: object
      required: [profile_id, awario_alert_id]
      properties:
        profile_id:
          type: string
          format: uuid
        connector_id:
          type: string
          format: uuid
          nullable: true
        awario_alert_id:
          type: string
          minLength: 1
        status:
          $ref: '#/components/schemas/AwarioStatus'
        metadata:
          type: object
          additionalProperties: true
    UpdateAwarioAlertBindingRequest:
      type: object
      properties:
        profile_id:
          type: string
          format: uuid
        connector_id:
          type: string
          format: uuid
          nullable: true
        awario_alert_id:
          type: string
          minLength: 1
        status:
          $ref: '#/components/schemas/AwarioStatus'
        metadata:
          type: object
          additionalProperties: true
    AwarioRemoteAlert:
      type: object
      required: [alert_id, is_active, fetched_at]
      properties:
        alert_id:
          type: string
        name:
          type: string
          nullable: true
        is_active:
          type: boolean
        status_raw:
          type: string
          nullable: true
        fetched_at:
          type: string
          format: date-time
    AwarioRemoteAlertListResponse:
      type: object
      required: [items]
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/AwarioRemoteAlert'
    LinkAwarioAlertRequest:
      type: object
      properties:
        connector_id:
          type: string
          format: uuid
          nullable: true
        alias:
          type: string
          maxLength: 180
          nullable: true
        status:
          $ref: '#/components/schemas/AwarioStatus'
        metadata:
          type: object
          additionalProperties: true
    AwarioBackfillQueued:
      type: object
      required: [run_id, status, mode]
      properties:
        run_id:
          type: string
          format: uuid
        status:
          type: string
          enum: [queued]
        mode:
          type: string
          enum: [historical]
    LinkAwarioAlertResponse:
      type: object
      required: [binding, backfill]
      properties:
        binding:
          $ref: '#/components/schemas/AwarioAlertBinding'
        backfill:
          $ref: '#/components/schemas/AwarioBackfillQueued'
    OwnedAccount:
      type: object
      required: [id, plataforma, handle, nombre_cuenta, idioma, estado, tags_campana, created_at, updated_at]
      properties:
        id:
          type: string
          format: uuid
        plataforma:
          type: string
        handle:
          type: string
        nombre_cuenta:
          type: string
        linea_negocio:
          type: string
          nullable: true
        region_macro:
          type: string
          nullable: true
        idioma:
          type: string
        owner_equipo:
          type: string
          nullable: true
        estado:
          type: string
        tags_campana:
          type: array
          items:
            type: string
        metadata:
          type: object
          additionalProperties: true
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
    OwnedAccountListResponse:
      type: object
      required: [items]
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/OwnedAccount'
    CreateOwnedAccountRequest:
      type: object
      required: [platform, handle, account_name]
      properties:
        platform:
          type: string
          minLength: 1
        handle:
          type: string
          minLength: 2
        account_name:
          type: string
          minLength: 2
        business_line:
          type: string
        macro_region:
          type: string
        language:
          type: string
          default: es
        team_owner:
          type: string
        status:
          type: string
          default: active
        campaign_tags:
          type: array
          items:
            type: string
        metadata:
          type: object
          additionalProperties: true
    UpdateOwnedAccountRequest:
      type: object
      properties:
        platform:
          type: string
        handle:
          type: string
        account_name:
          type: string
        business_line:
          type: string
          nullable: true
        macro_region:
          type: string
          nullable: true
        language:
          type: string
        team_owner:
          type: string
          nullable: true
        status:
          type: string
        campaign_tags:
          type: array
          items:
            type: string
        metadata:
          type: object
          additionalProperties: true
    Competitor:
      type: object
      required: [id, marca_competidora, aliases, prioridad, estado, created_at, updated_at]
      properties:
        id:
          type: string
          format: uuid
        marca_competidora:
          type: string
        aliases:
          type: array
          items:
            type: string
        prioridad:
          type: integer
        estado:
          type: string
        metadata:
          type: object
          additionalProperties: true
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
    CompetitorListResponse:
      type: object
      required: [items]
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/Competitor'
    CreateCompetitorRequest:
      type: object
      required: [brand_name]
      properties:
        brand_name:
          type: string
        aliases:
          type: array
          items:
            type: string
        priority:
          type: integer
          minimum: 1
          maximum: 10
        status:
          type: string
        metadata:
          type: object
          additionalProperties: true
    UpdateCompetitorRequest:
      type: object
      properties:
        brand_name:
          type: string
        aliases:
          type: array
          items:
            type: string
        priority:
          type: integer
          minimum: 1
          maximum: 10
        status:
          type: string
        metadata:
          type: object
          additionalProperties: true
    TaxonomyEntry:
      type: object
      required: [id, kind, key, label, is_active, sort_order, created_at, updated_at]
      properties:
        id:
          type: string
          format: uuid
        kind:
          type: string
          enum: [categories, business_lines, macro_regions, campaigns]
        key:
          type: string
        label:
          type: string
        description:
          type: string
          nullable: true
        is_active:
          type: boolean
        sort_order:
          type: integer
        metadata:
          type: object
          additionalProperties: true
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
    TaxonomyListResponse:
      type: object
      required: [kind, items]
      properties:
        kind:
          type: string
          enum: [categories, business_lines, macro_regions, campaigns]
        items:
          type: array
          items:
            $ref: '#/components/schemas/TaxonomyEntry'
    CreateTaxonomyEntryRequest:
      type: object
      required: [key, label]
      properties:
        key:
          type: string
        label:
          type: string
        description:
          type: string
        is_active:
          type: boolean
          default: true
        sort_order:
          type: integer
          default: 100
        metadata:
          type: object
          additionalProperties: true
    UpdateTaxonomyEntryRequest:
      type: object
      properties:
        key:
          type: string
        label:
          type: string
        description:
          type: string
          nullable: true
        is_active:
          type: boolean
        sort_order:
          type: integer
        metadata:
          type: object
          additionalProperties: true
    SourceWeight:
      type: object
      required: [id, provider, weight, is_active, created_at, updated_at]
      properties:
        id:
          type: string
          format: uuid
        provider:
          type: string
        source_name:
          type: string
          nullable: true
        weight:
          type: number
          minimum: 0
          maximum: 1
        is_active:
          type: boolean
        updated_by_user_id:
          type: string
          format: uuid
          nullable: true
        updated_by_name:
          type: string
          nullable: true
        updated_by_email:
          type: string
          nullable: true
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
    SourceWeightListResponse:
      type: object
      required: [items]
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/SourceWeight'
    CreateSourceWeightRequest:
      type: object
      required: [provider, weight]
      properties:
        provider:
          type: string
        source_name:
          type: string
          nullable: true
        weight:
          type: number
          minimum: 0
          maximum: 1
        is_active:
          type: boolean
          default: true
    UpdateSourceWeightRequest:
      type: object
      properties:
        source_name:
          type: string
          nullable: true
        weight:
          type: number
          minimum: 0
          maximum: 1
        is_active:
          type: boolean
    NotificationRecipientKind:
      type: string
      enum: [digest, incident]
    NotificationRecipient:
      type: object
      required: [id, kind, scope, email_masked, is_active, created_at, updated_at]
      properties:
        id:
          type: string
          format: uuid
        kind:
          $ref: '#/components/schemas/NotificationRecipientKind'
        scope:
          type: string
        email:
          type: string
          nullable: true
        email_masked:
          type: string
        is_active:
          type: boolean
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
    NotificationRecipientListResponse:
      type: object
      required: [items]
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/NotificationRecipient'
    CreateNotificationRecipientRequest:
      type: object
      required: [kind, email]
      properties:
        kind:
          $ref: '#/components/schemas/NotificationRecipientKind'
        scope:
          type: string
          default: ops
        email:
          type: string
        is_active:
          type: boolean
          default: true
    UpdateNotificationRecipientRequest:
      type: object
      properties:
        scope:
          type: string
        email:
          type: string
        is_active:
          type: boolean
    NotificationEmailStatusResponse:
      type: object
      required: [production_access_enabled, sending_enabled, send_quota, sender_email, sender_verification_status, sender_verified_for_sending]
      properties:
        production_access_enabled:
          type: boolean
        sending_enabled:
          type: boolean
        send_quota:
          type: object
          required: [max_24_hour_send, max_send_rate, sent_last_24_hours]
          properties:
            max_24_hour_send:
              type: number
              nullable: true
            max_send_rate:
              type: number
              nullable: true
            sent_last_24_hours:
              type: number
              nullable: true
        sender_email:
          type: string
          nullable: true
        sender_verification_status:
          type: string
          nullable: true
        sender_verified_for_sending:
          type: boolean
    AuditItem:
      type: object
      required: [id, action, resource_type, created_at]
      properties:
        id:
          type: string
          format: uuid
        actor_user_id:
          type: string
          format: uuid
          nullable: true
        actor_email:
          type: string
          nullable: true
        actor_name:
          type: string
          nullable: true
        actor_role:
          type: string
          nullable: true
        action:
          type: string
        resource_type:
          type: string
        resource_id:
          type: string
          nullable: true
        request_id:
          type: string
          nullable: true
        before:
          type: object
          nullable: true
          additionalProperties: true
        after:
          type: object
          nullable: true
          additionalProperties: true
        created_at:
          type: string
          format: date-time
    AuditListResponse:
      type: object
      required: [items, page_info]
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/AuditItem'
        page_info:
          $ref: '#/components/schemas/PageInfo'
    CreateAuditExportRequest:
      type: object
      properties:
        filters:
          type: object
          properties:
            resource_type:
              type: string
            action:
              type: string
            actor_user_id:
              type: string
              format: uuid
            from:
              type: string
              format: date-time
            to:
              type: string
              format: date-time
          additionalProperties: false
        limit:
          type: integer
          minimum: 1
          maximum: 5000
          default: 2000
    AuditExportResponse:
      type: object
      required: [export_id, status, format, row_count, created_at, download_url]
      properties:
        export_id:
          type: string
          format: uuid
        status:
          type: string
          const: completed
        format:
          type: string
          const: csv
        row_count:
          type: integer
        created_at:
          type: string
          format: date-time
        download_url:
          type: string
          format: uri
        s3_key:
          type: string
        requested_by_user_id:
          type: string
          format: uuid
        request_id:
          type: string
    ContentListResponse:
      type: object
      required: [items, page_info]
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/ContentItem'
        page_info:
          $ref: '#/components/schemas/PageInfo'
    NewsFeedResponse:
      type: object
      required: [term_id, limit, items, page_info]
      properties:
        term_id:
          type: string
          format: uuid
        limit:
          type: integer
          minimum: 1
          maximum: 200
        items:
          type: array
          items:
            $ref: '#/components/schemas/ContentItem'
        page_info:
          $ref: '#/components/schemas/PageInfo'
    PageInfo:
      type: object
      required: [has_next]
      properties:
        next_cursor:
          type: string
          nullable: true
        has_next:
          type: boolean
